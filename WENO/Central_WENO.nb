(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    159643,       5072]
NotebookOptionsPosition[    150906,       4788]
NotebookOutlinePosition[    151249,       4803]
CellTagsIndexPosition[    151206,       4800]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Centered WENO Derivates", "Title"]], "Title",
 CellChangeTimes->{{3.572605317638055*^9, 3.572605345719661*^9}, {
  3.5726103894041433`*^9, 3.572610506515842*^9}, {3.572610700259924*^9, 
  3.572610726388418*^9}, {3.583042235805499*^9, 3.583042236795696*^9}, {
  3.5832134161311474`*^9, 3.583213418139262*^9}}],

Cell["\<\
coded by Manuel Diaz, 2013.03.18
manuel.ade\[CloseCurlyQuote]at\[CloseCurlyQuote]gmail.com\
\>", "Subtitle",
 CellChangeTimes->{{3.5832084306679955`*^9, 3.5832084442187705`*^9}, 
   3.5832133685094237`*^9, 3.583476899353537*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Quit", "[", "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Reset", " ", "Mathematica", " ", "Kernel"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5725992659605007`*^9, 3.5725992704065084`*^9}, {
  3.583042451791565*^9, 3.58304246293111*^9}}],

Cell[CellGroupData[{

Cell["Refs,", "Subsection",
 CellChangeTimes->{{3.583042480112713*^9, 3.583042483546009*^9}}],

Cell["\<\
This Mathematica files is helpful to derive the coeficients to implement \
first and/or second order WENO based derivates following the ideas of the \
following references
\t 1. Shu; ' High order weighted essentially nonoscillatory schemes for \
convection dominated problems'. SIAM review 2009 
\t 2. Also following many ideas in the publication by RhysU@http : // \
www.scribd.com/RhysU \
\>", "Text",
 CellChangeTimes->{{3.583042527793134*^9, 3.583042533881814*^9}, {
  3.583043419652944*^9, 3.583043469016687*^9}, {3.594986873348792*^9, 
  3.594986909300843*^9}, {3.5949869853259497`*^9, 3.59498698575595*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

WENO Derivates Implementation\
\>", "Section",
 CellChangeTimes->{{3.583042596999517*^9, 3.583042619903374*^9}, {
   3.583043830381129*^9, 3.58304383137195*^9}, 3.583049552550931*^9}],

Cell[BoxData[
 RowBox[{"We", " ", "need", " ", "to", " ", "build", " ", "a", " ", "list", 
  " ", "of", " ", "uniform", " ", "gridpoints", " ", "with", " ", "spacing", 
  " ", "\[CapitalDelta]x", " ", "and", " ", "fucntion", " ", "values", " ", 
  RowBox[{
   SubscriptBox["f", "i"], ".", " ", "Use"}], " ", "that", " ", "list", " ", 
  "to", " ", "build", " ", "the", " ", 
  SuperscriptBox["j", "th"], " ", "interpolating", " ", "Polynomial", " ", 
  "for", " ", "j", " ", "\[Epsilon]", " ", 
  RowBox[{"{", 
   RowBox[{"1", ",", "...", ",", "r"}], "}"}]}]], "Text",
 CellChangeTimes->{3.594986959633913*^9}],

Cell[CellGroupData[{

Cell["Stencils and Substencils", "Subsection",
 CellChangeTimes->{{3.583042320877539*^9, 3.583042330722378*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"StencilPoints", "[", "r_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", " ", "\[CapitalDelta]x"}], ",", " ", 
      SubscriptBox["u", "i"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"r", "-", "1"}], ")"}]}], ",", 
      RowBox[{"(", 
       RowBox[{"r", "-", "1"}], ")"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SubstencilPoints", "[", 
   RowBox[{"r_", ",", "j_"}], "]"}], ":=", " ", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"StencilPoints", "[", "r", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"j", "+", "r", "-", "1"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StencilPolynomial", "[", 
   RowBox[{"r_", ",", "j_"}], "]"}], ":=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"InterpolatingPolynomial", "[", 
     RowBox[{
      RowBox[{"SubstencilPoints", "[", 
       RowBox[{"r", ",", "j"}], "]"}], ",", "x"}], "]"}], ",", "u", ",", 
    "Simplify"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.572599103947753*^9, 3.572599105648156*^9}, {
   3.5725996916422663`*^9, 3.5725996932093563`*^9}, 3.5725999012092533`*^9}],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{" ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Check", " ", "these", " ", "functions", " ", "will", " ", "return", 
        " ", "the", " ", "three", " ", "expected", " ", "interpolant", " ", 
        "values", " ", "at", " ", 
        RowBox[{"\[CapitalDelta]x", "/", "2"}], " ", "for", " ", "the", " ", 
        "r"}], "=", 
       RowBox[{"3", " ", "case", " ", 
        RowBox[{"from", " ", "[", "1", "]"}]}]}], ",", " ", 
      RowBox[{"equations", " ", 
       RowBox[{"(", "2.1", ")"}]}], ",", " ", "2.2"}], ")"}], " ", "and", " ", 
    RowBox[{"(", "2.3", ")"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{3.572599112449768*^9}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Testing", "Subsubsection"]], "Subsubsection",
 CellChangeTimes->{{3.583042311833031*^9, 3.583042314133602*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StencilPoints", "[", "3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"StencilPolynomial", "[", 
  RowBox[{"3", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"StencilPolynomial", "[", 
     RowBox[{"3", ",", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"d", "=", "2"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"StencilPolynomial", "[", 
       RowBox[{"3", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "3"}], "}"}]}], "]"}], " ", "//.", 
    RowBox[{"x", "\[Rule]", " ", 
     RowBox[{"\[CapitalDelta]x", "/", "2"}]}]}], " ", "//", " ", "Expand"}], 
  " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.572599116334175*^9, 3.5725991689887247`*^9}, {
   3.5725992096527762`*^9, 3.5725992363984485`*^9}, {3.572599707718186*^9, 
   3.5725997141735554`*^9}, 3.583034785859619*^9, {3.583037149186316*^9, 
   3.583037179321292*^9}, {3.583037221856121*^9, 3.583037266964649*^9}, {
   3.583037337033346*^9, 3.583037349561879*^9}, {3.583037474681265*^9, 
   3.583037510552155*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[CapitalDelta]x"}], ",", 
     SubscriptBox["u", 
      RowBox[{"-", "2"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "\[CapitalDelta]x"}], ",", 
     SubscriptBox["u", 
      RowBox[{"-", "1"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SubscriptBox["u", "0"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalDelta]x", ",", 
     SubscriptBox["u", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", "\[CapitalDelta]x"}], ",", 
     SubscriptBox["u", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5725992791269236`*^9, 3.5725997210689497`*^9, 3.572599773059923*^9, 
   3.5725999073186026`*^9, {3.583037172426328*^9, 3.583037180267103*^9}, {
   3.583037222785674*^9, 3.583037267572315*^9}, {3.583037338201884*^9, 
   3.583037350318213*^9}, {3.583037475522281*^9, 3.583037493607873*^9}, 
   3.5943440551448936`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"x", " ", 
    RowBox[{"(", 
     RowBox[{"x", "+", "\[CapitalDelta]x"}], ")"}], " ", 
    SubscriptBox["u", 
     RowBox[{"-", "2"}]]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x", "+", 
      RowBox[{"2", " ", "\[CapitalDelta]x"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "x", " ", 
       SubscriptBox["u", 
        RowBox[{"-", "1"}]]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "+", "\[CapitalDelta]x"}], ")"}], " ", 
       SubscriptBox["u", "0"]}]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["\[CapitalDelta]x", "2"]}]]], "Output",
 CellChangeTimes->{
  3.5725992791269236`*^9, 3.5725997210689497`*^9, 3.572599773059923*^9, 
   3.5725999073186026`*^9, {3.583037172426328*^9, 3.583037180267103*^9}, {
   3.583037222785674*^9, 3.583037267572315*^9}, {3.583037338201884*^9, 
   3.583037350318213*^9}, {3.583037475522281*^9, 3.583037493607873*^9}, 
   3.594344055147894*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "2"}]]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["u", 
        RowBox[{"-", "1"}]]}], "+", 
      SubscriptBox["u", "0"]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["\[CapitalDelta]x", "2"]}]]], "Output",
 CellChangeTimes->{
  3.5725992791269236`*^9, 3.5725997210689497`*^9, 3.572599773059923*^9, 
   3.5725999073186026`*^9, {3.583037172426328*^9, 3.583037180267103*^9}, {
   3.583037222785674*^9, 3.583037267572315*^9}, {3.583037338201884*^9, 
   3.583037350318213*^9}, {3.583037475522281*^9, 3.583037493607873*^9}, 
   3.594344055168895*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox[
         RowBox[{"3", " ", 
          SubscriptBox["u", 
           RowBox[{"-", "2"}]]}], "8"], "-", 
        FractionBox[
         RowBox[{"5", " ", 
          SubscriptBox["u", 
           RowBox[{"-", "1"}]]}], "4"], "+", 
        FractionBox[
         RowBox[{"15", " ", 
          SubscriptBox["u", "0"]}], "8"]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], "8"]}], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SubscriptBox["u", "0"]}], "4"], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SubscriptBox["u", "1"]}], "8"]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"3", " ", 
          SubscriptBox["u", "0"]}], "8"], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SubscriptBox["u", "1"]}], "4"], "-", 
        FractionBox[
         SubscriptBox["u", "2"], "8"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.5725992791269236`*^9, 3.5725997210689497`*^9, 3.572599773059923*^9, 
   3.5725999073186026`*^9, {3.583037172426328*^9, 3.583037180267103*^9}, {
   3.583037222785674*^9, 3.583037267572315*^9}, {3.583037338201884*^9, 
   3.583037350318213*^9}, {3.583037475522281*^9, 3.583037493607873*^9}, 
   3.594344055171895*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Let", " ", "us", " ", "then", " ", "compute", " ", "smoothness", " ", 
   "indicartors", " ", "as", " ", "in", " ", 
   RowBox[{"ref", ".", " ", 
    RowBox[{"[", "2", "]"}], "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5726001507575264`*^9, 3.572600203932568*^9}, 
   3.583034789867814*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Smooth Indicators", "Subsection",
 CellChangeTimes->{{3.583042343309065*^9, 3.583042349365427*^9}, 
   3.583042576726254*^9}],

Cell["\<\
Here we use the classical expresion proposed in ref [2]:\
\>", "Text",
 CellChangeTimes->{{3.583036474251028*^9, 3.583036480646721*^9}, {
  3.583036527509505*^9, 3.583036549387887*^9}, {3.583036739613175*^9, 
  3.58303686217936*^9}, {3.583036917564639*^9, 3.583036972633553*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["\[Beta]", 
     RowBox[{"j", " "}]], "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"l", "=", "1"}], "k"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       SubscriptBox["x", 
        RowBox[{"i", "-", 
         RowBox[{"1", "/", "2"}]}]], 
       SubscriptBox["x", 
        RowBox[{"i", "+", 
         RowBox[{"1", "/", "2"}]}]]], 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[CapitalDelta]x", 
          RowBox[{
           RowBox[{"2", "l"}], "-", "1"}]], "(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[PartialD]", "l"], 
           RowBox[{
            SubscriptBox["p", "j"], "[", "x", "]"}]}], 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "l"]}]], ")"}], "2"], 
       RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], " ", ",", " ", 
   RowBox[{
   "where", " ", "k", " ", "is", " ", "the", " ", "polynomial", " ", 
    "degree"}], ",", " ", 
   RowBox[{"k", " ", "=", 
    RowBox[{"r", "-", "1."}]}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.583036976474272*^9, 3.583036976512499*^9}, {
  3.583037759836641*^9, 3.583037768408283*^9}, {3.583037837911321*^9, 
  3.583037893926932*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"StencilSmoothness", "[", 
   RowBox[{"r_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Together", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[CapitalDelta]x", 
        RowBox[{
         RowBox[{"2", "d"}], "-", "1"}]], 
       RowBox[{"Integrate", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"StencilPolynomial", "[", 
             RowBox[{"r", ",", "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "d"}], "}"}]}], "]"}], "2"], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"-", "\[CapitalDelta]x"}], "/", "2"}], ",", 
           RowBox[{"\[CapitalDelta]x", "/", "2"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", 
        RowBox[{"r", "-", "1"}]}], "}"}]}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5726021281746283`*^9, 3.572602156901271*^9}, {
  3.5726022142945538`*^9, 3.5726023252699013`*^9}, {3.5726026616731424`*^9, 
  3.5726026619371576`*^9}, {3.572602696568138*^9, 3.5726027269688773`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Check", " ", "Smoothness", " ", "indicartors", " ", "against", " ", "the",
     " ", "result", " ", 
    RowBox[{"from", " ", "[", "1", "]"}]}], ",", " ", 
   RowBox[{"equation", " ", 
    RowBox[{"(", "2.9", ")"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5726023692454166`*^9, 3.5726024172691636`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StencilSmoothness", "[", 
  RowBox[{"3", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StencilSmoothness", "[", 
  RowBox[{"3", ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StencilSmoothness", "[", 
  RowBox[{"3", ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.572602418288222*^9, 3.5726024587095337`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "3"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", 
     SubsuperscriptBox["u", 
      RowBox[{"-", "2"}], "2"]}], "-", 
    RowBox[{"19", " ", 
     SubscriptBox["u", 
      RowBox[{"-", "2"}]], " ", 
     SubscriptBox["u", 
      RowBox[{"-", "1"}]]}], "+", 
    RowBox[{"25", " ", 
     SubsuperscriptBox["u", 
      RowBox[{"-", "1"}], "2"]}], "+", 
    RowBox[{"11", " ", 
     SubscriptBox["u", 
      RowBox[{"-", "2"}]], " ", 
     SubscriptBox["u", "0"]}], "-", 
    RowBox[{"31", " ", 
     SubscriptBox["u", 
      RowBox[{"-", "1"}]], " ", 
     SubscriptBox["u", "0"]}], "+", 
    RowBox[{"10", " ", 
     SubsuperscriptBox["u", "0", "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.5726024397294483`*^9, 3.5726026664934187`*^9, 
  3.572602730635087*^9, 3.5943440557039256`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "3"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", 
     SubsuperscriptBox["u", 
      RowBox[{"-", "1"}], "2"]}], "-", 
    RowBox[{"13", " ", 
     SubscriptBox["u", 
      RowBox[{"-", "1"}]], " ", 
     SubscriptBox["u", "0"]}], "+", 
    RowBox[{"13", " ", 
     SubsuperscriptBox["u", "0", "2"]}], "+", 
    RowBox[{"5", " ", 
     SubscriptBox["u", 
      RowBox[{"-", "1"}]], " ", 
     SubscriptBox["u", "1"]}], "-", 
    RowBox[{"13", " ", 
     SubscriptBox["u", "0"], " ", 
     SubscriptBox["u", "1"]}], "+", 
    RowBox[{"4", " ", 
     SubsuperscriptBox["u", "1", "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.5726024397294483`*^9, 3.5726026664934187`*^9, 
  3.572602730635087*^9, 3.594344055824932*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "3"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"10", " ", 
     SubsuperscriptBox["u", "0", "2"]}], "-", 
    RowBox[{"31", " ", 
     SubscriptBox["u", "0"], " ", 
     SubscriptBox["u", "1"]}], "+", 
    RowBox[{"25", " ", 
     SubsuperscriptBox["u", "1", "2"]}], "+", 
    RowBox[{"11", " ", 
     SubscriptBox["u", "0"], " ", 
     SubscriptBox["u", "2"]}], "-", 
    RowBox[{"19", " ", 
     SubscriptBox["u", "1"], " ", 
     SubscriptBox["u", "2"]}], "+", 
    RowBox[{"4", " ", 
     SubsuperscriptBox["u", "2", "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.5726024397294483`*^9, 3.5726026664934187`*^9, 
  3.572602730635087*^9, 3.5943440559449396`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving Weigth factors", "Subsection",
 CellChangeTimes->{{3.583042366172613*^9, 3.583042371475773*^9}, {
  3.583042418702847*^9, 3.583042433902089*^9}, {3.583042924210016*^9, 
  3.583042924594528*^9}, {3.58304309756509*^9, 3.583043097738704*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Using", " ", "Horner", " ", "factorization", " ", "of", " ", "the", " ", 
    "smoothness", " ", "indicators", " ", "may", " ", "provide", " ", "a", 
    " ", "cleaner", " ", 
    RowBox[{"(", 
     RowBox[{"and", " ", "more", " ", "performant"}], ")"}], " ", 
    "representation", " ", "when", " ", "r"}], ">", "3"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5726027555315113`*^9, 3.572602876277417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmoothnessFactor", "[", 
   RowBox[{"r_", ",", "A_"}], "]"}], ":=", " ", 
  RowBox[{"Map", "[", 
   RowBox[{"Together", ",", 
    RowBox[{"HornerForm", "[", 
     RowBox[{"A", ",", 
      RowBox[{"Last", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"StencilPoints", "[", "r", "]"}], "]"}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.572602879142581*^9, 3.5726028806296663`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"The", " ", "Optimal"}], ",", " ", 
   RowBox[{
    RowBox[{"full", "-", 
     RowBox[{
     "with", " ", "stencil", " ", "contribution", " ", "for", " ", "a", " ", 
      "given", " ", "derivate", " ", "at", " ", "x"}]}], " ", "=", " ", 
    RowBox[{"0", " ", "are"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.572602887965086*^9, 3.5726029214209995`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Optimal", "[", 
   RowBox[{"r_", ",", "d_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"InterpolatingPolynomial", "[", 
       RowBox[{
        RowBox[{"StencilPoints", "[", "r", "]"}], ",", "x"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "d"}], "}"}]}], "]"}], "//.", 
    RowBox[{"x", "\[Rule]", "0"}]}], " ", "//", "Together"}]}]], "Input",
 CellChangeTimes->{{3.5726029260582647`*^9, 3.5726029418451676`*^9}, {
  3.57260429756571*^9, 3.5726043604383063`*^9}, {3.572604406958967*^9, 
  3.572604409838132*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"The", " ", "stencil"}], "-", "by", "-", 
    RowBox[{
    "stencil", " ", "contributions", " ", "for", " ", "a", " ", "given", " ", 
     "derivate", " ", "at", " ", "x"}]}], "=", 
   RowBox[{"0", " ", "are"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.572604416602519*^9, 3.5726045704693193`*^9}, {
  3.5726046271015587`*^9, 3.572604664524699*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Contributions", "[", 
   RowBox[{"r_", ",", "d_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StencilPolynomial", "[", 
         RowBox[{"r", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "r"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "d"}], "}"}]}], "]"}], "//.", 
    RowBox[{"x", "\[Rule]", " ", "0"}]}], "//", " ", "Together"}]}]], "Input",
 CellChangeTimes->{{3.5726047487835183`*^9, 3.572604754838865*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "The", " ", "linear", " ", "weights", " ", "must", " ", "satisfy", " ", 
    "these", " ", "constrains", " ", "resulting", " ", "from", " ", 
    "combining", " ", "the", " ", "stencil"}], "-", "by", "-", 
   RowBox[{
   "stencil", " ", "contributions", " ", "to", " ", "math", " ", "the", " ", 
    "optimal", " ", 
    RowBox[{"result", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5726045819869785`*^9, 3.572604622278283*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinearWeights", "[", 
   RowBox[{"r_", ",", "d_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Quiet", "[", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Gamma]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["\[Gamma]", "j"], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "r"}], "}"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Gamma]", ".", 
            RowBox[{"Contributions", "[", 
             RowBox[{"r", ",", "d"}], "]"}]}], "\[Equal]", 
           RowBox[{"Optimal", "[", 
            RowBox[{"r", ",", "d"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Total", "[", "\[Gamma]", "]"}], "\[Equal]", "1"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[Gamma]", ",", "Reals"}], 
       "]"}]}], "]"}], "]"}], "/.", " ", 
   RowBox[{"Rule", "\[Rule]", "Equal"}]}]}]], "Input",
 CellChangeTimes->{{3.5726047667365456`*^9, 3.572604949937024*^9}, {
   3.5726078110586705`*^9, 3.572607813937835*^9}, 3.583039281380864*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solving Weigth factors by Linear system of equations\
\>", "Subsection",
 CellChangeTimes->{{3.583042931017988*^9, 3.583042935356433*^9}, {
  3.583043122014502*^9, 3.583043122182234*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "We", " ", "will", " ", "need", " ", "to", " ", "extrac", " ", "tables", 
    " ", "of", " ", "coefficients", " ", "of", " ", 
    RowBox[{
     SubscriptBox["u", "i"], "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CoefficientTable", "[", 
    RowBox[{"r_", ",", "A_"}], "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"A", ",", 
       SubscriptBox["u", "i"]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"r", "-", "1"}], ")"}]}], ",", 
       RowBox[{"(", 
        RowBox[{"r", "-", "1"}], ")"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5726049685590887`*^9, 3.5726050586072397`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "We", " ", "will", " ", "want", " ", "to", " ", "perform", " ", "linear", 
   " ", "solves", " ", "on", " ", "these", " ", "tables", " ", "of", " ", 
   "coefficients"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.572605065456631*^9, 3.5726051688615456`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinearSolveWeights", "[", 
   RowBox[{"r_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{
    RowBox[{"CoefficientTable", "[", 
     RowBox[{"r", ",", 
      RowBox[{"Contributions", "[", 
       RowBox[{"r", ",", "d"}], "]"}]}], "]"}], ",", 
    RowBox[{"CoefficientTable", "[", 
     RowBox[{"r", ",", 
      RowBox[{"Optimal", "[", 
       RowBox[{"r", ",", "d"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5726081699681993`*^9, 3.5726081703352203`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "The", " ", "nonlinear", " ", "weights", " ", "should", " ", "be", " ", 
   "computed", " ", "in", " ", "the", " ", "usual", " ", "WENO", " ", 
   "manner", " ", "from", " ", "these", " ", "linear", " ", "weights", " ", 
   "following", " ", 
   RowBox[{
    RowBox[{"ref", "[", "1", "]"}], ".", " ", "equation"}], " ", 
   RowBox[{"(", "2.10", ")"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5726051795291557`*^9, 3.5726052410296736`*^9}, {
  3.5726052830050745`*^9, 3.572605285397211*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\

3-Point WENO derivate Stencils\
\>", "Section",
 CellChangeTimes->{{3.572605248564104*^9, 3.572605290499503*^9}, {
  3.583042670875042*^9, 3.583042683973483*^9}, {3.583042754549838*^9, 
  3.583042759046655*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", "=", " ", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.5726061640884695`*^9, 3.5726061687087336`*^9}, {
  3.583042643106193*^9, 3.583042670957854*^9}}],

Cell[CellGroupData[{

Cell["First Derivate", "Subsection",
 CellChangeTimes->{{3.572608348455408*^9, 3.572608348456408*^9}, {
  3.58304264310971*^9, 3.583042692413207*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Display", " ", "the", " ", "optimal", " ", "3"}], "-", 
    RowBox[{
    "point", " ", "stencil", "  ", "coefficients", " ", "for", " ", "the", 
     " ", "derivate"}]}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "2"}], "-", 
    RowBox[{"point", " ", "substencil", " ", "coefficients"}]}], ",", " ", 
   RowBox[{
   "and", " ", "the", " ", "linear", " ", "weights", " ", "necessary", " ", 
    "to", " ", "recover", " ", "the", " ", "maximun", " ", "order", " ", "of",
     " ", "accuaracy"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.572606213300284*^9, 3.5726062651252484`*^9}, {
  3.5726075736220903`*^9, 3.5726076197177267`*^9}, {3.572608350308514*^9, 
  3.5726083506145315`*^9}, {3.583042643114822*^9, 3.583042671048956*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", " ", "=", " ", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"o", "[", 
   RowBox[{"r", ",", " ", "d"}], "]"}], " ", "=", " ", 
  RowBox[{"Optimal", "[", 
   RowBox[{"r", ",", " ", "d"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"s", "[", 
   RowBox[{"r", ",", " ", "d"}], "]"}], " ", "=", " ", 
  RowBox[{"Contributions", "[", 
   RowBox[{"r", ",", " ", "d"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"w", "[", 
   RowBox[{"r", ",", " ", "d"}], "]"}], " ", "=", " ", 
  RowBox[{"LinearWeights", "[", 
   RowBox[{"r", ",", " ", "d"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5726076268121324`*^9, 3.5726076805032034`*^9}, {
  3.583042643117617*^9, 3.583042671094932*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    SubscriptBox["u", 
     RowBox[{"-", "1"}]]}], "+", 
   SubscriptBox["u", "1"]}], 
  RowBox[{"2", " ", "\[CapitalDelta]x"}]]], "Input",
 CellChangeTimes->{
  3.5726076830733504`*^9, 3.5726078241364183`*^9, {3.572608610342387*^9, 
   3.5726086172807837`*^9}, {3.583042644494471*^9, 3.583042644812743*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     SubscriptBox["u", "0"]}], "\[CapitalDelta]x"], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["u", "0"]}], "+", 
     SubscriptBox["u", "1"]}], "\[CapitalDelta]x"]}], "}"}]], "Input",
 CellChangeTimes->{
  3.5726076830733504`*^9, 3.5726078241364183`*^9, {3.572608610342387*^9, 
   3.572608617283784*^9}, {3.583042644499524*^9, 3.583042644814576*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Gamma]", "1"], "\[Equal]", 
     FractionBox["1", "2"]}], ",", 
    RowBox[{
     SubscriptBox["\[Gamma]", "2"], "\[Equal]", 
     FractionBox["1", "2"]}]}], "}"}], "}"}]], "Input",
 CellChangeTimes->{
  3.5726076830733504`*^9, 3.5726078241364183`*^9, {3.572608610342387*^9, 
   3.572608617300785*^9}, {3.583042644502498*^9, 3.583042644816464*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Smoothness Indicators", "Subsection",
 CellChangeTimes->{{3.5726085929183903`*^9, 3.5726085973656445`*^9}, {
   3.583042644505153*^9, 3.583042671140466*^9}, 3.58304279846045*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StencilSmoothness", "[", 
      RowBox[{"r", ",", " ", "j"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "r"}], "}"}]}], "]"}], " ", "//", " ", 
   "Simplify"}], " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.572607718802394*^9, 3.5726077723894587`*^9}, {
  3.5726085908862743`*^9, 3.572608591318299*^9}, {3.583042644507965*^9, 
  3.583042671188377*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], "-", 
          SubscriptBox["u", "0"]}], ")"}], "2"]},
      {
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["u", "0"], "-", 
          SubscriptBox["u", "1"]}], ")"}], "2"]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Input",
 CellChangeTimes->{
  3.5726077735735264`*^9, {3.5726086010928583`*^9, 3.5726086196549196`*^9}, {
   3.583042644512647*^9, 3.583042644819496*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\

5-Point WENO derivate stencils\
\>", "Section",
 CellChangeTimes->{{3.572607843684537*^9, 3.572607866787858*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.5726078706680803`*^9, 3.572607911645424*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["First Derivate", "Subsection"]], "Subsection",
 CellChangeTimes->{{3.572608316940605*^9, 3.5726083189717216`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Display", " ", "the", " ", "optimal", " ", "5"}], "-", 
    RowBox[{
    "point", " ", "stencil", "  ", "coefficients", " ", "for", " ", "the", 
     " ", "derivate"}]}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "3"}], "-", 
    RowBox[{"point", " ", "substencil", " ", "coefficients"}]}], ",", " ", 
   RowBox[{
   "and", " ", "the", " ", "linear", " ", "weights", " ", "necessary", " ", 
    "to", " ", "recover", " ", "the", " ", "maximun", " ", "order", " ", "of",
     " ", "accuaracy"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5726083340285826`*^9, 3.5726083361177025`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"o", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", " ", 
  RowBox[{"Optimal", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"Contributions", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"LinearWeights", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}]}], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SubscriptBox["u", 
    RowBox[{"-", "2"}]], "-", 
   RowBox[{"8", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "1"}]]}], "+", 
   RowBox[{"8", " ", 
    SubscriptBox["u", "1"]}], "-", 
   SubscriptBox["u", "2"]}], 
  RowBox[{"12", " ", "\[CapitalDelta]x"}]]], "Output",
 CellChangeTimes->{{3.5726079010248165`*^9, 3.5726079171247373`*^9}, 
   3.5726086408901343`*^9, 3.5726096493138127`*^9, 3.5943440602651863`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "2"}]], "-", 
     RowBox[{"4", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"3", " ", 
      SubscriptBox["u", "0"]}]}], 
    RowBox[{"2", " ", "\[CapitalDelta]x"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     SubscriptBox["u", "1"]}], 
    RowBox[{"2", " ", "\[CapitalDelta]x"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"4", " ", 
      SubscriptBox["u", "1"]}], "-", 
     SubscriptBox["u", "2"]}], 
    RowBox[{"2", " ", "\[CapitalDelta]x"}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.5726079010248165`*^9, 3.5726079171247373`*^9}, 
   3.5726086408901343`*^9, 3.5726096493138127`*^9, 3.594344060269187*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Gamma]", "1"], "\[Equal]", 
     RowBox[{"1", "-", 
      SubscriptBox["\[Gamma]", "2"], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"5", " ", 
         SubscriptBox["u", 
          RowBox[{"-", "2"}]]}], "-", 
        RowBox[{"16", " ", 
         SubscriptBox["u", 
          RowBox[{"-", "1"}]]}], "+", 
        RowBox[{"18", " ", 
         SubscriptBox["u", "0"]}], "-", 
        RowBox[{"8", " ", 
         SubscriptBox["u", "1"]}], "+", 
        SubscriptBox["u", "2"], "-", 
        RowBox[{"6", " ", 
         SubscriptBox["u", 
          RowBox[{"-", "2"}]], " ", 
         SubscriptBox["\[Gamma]", "2"]}], "+", 
        RowBox[{"18", " ", 
         SubscriptBox["u", 
          RowBox[{"-", "1"}]], " ", 
         SubscriptBox["\[Gamma]", "2"]}], "-", 
        RowBox[{"18", " ", 
         SubscriptBox["u", "0"], " ", 
         SubscriptBox["\[Gamma]", "2"]}], "+", 
        RowBox[{"6", " ", 
         SubscriptBox["u", "1"], " ", 
         SubscriptBox["\[Gamma]", "2"]}]}], 
       RowBox[{
        RowBox[{"6", " ", 
         SubscriptBox["u", 
          RowBox[{"-", "2"}]]}], "-", 
        RowBox[{"24", " ", 
         SubscriptBox["u", 
          RowBox[{"-", "1"}]]}], "+", 
        RowBox[{"36", " ", 
         SubscriptBox["u", "0"]}], "-", 
        RowBox[{"24", " ", 
         SubscriptBox["u", "1"]}], "+", 
        RowBox[{"6", " ", 
         SubscriptBox["u", "2"]}]}]]}]}], ",", 
    RowBox[{
     SubscriptBox["\[Gamma]", "3"], "\[Equal]", 
     FractionBox[
      RowBox[{
       RowBox[{"5", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]]}], "-", 
       RowBox[{"16", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "+", 
       RowBox[{"18", " ", 
        SubscriptBox["u", "0"]}], "-", 
       RowBox[{"8", " ", 
        SubscriptBox["u", "1"]}], "+", 
       SubscriptBox["u", "2"], "-", 
       RowBox[{"6", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]], " ", 
        SubscriptBox["\[Gamma]", "2"]}], "+", 
       RowBox[{"18", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]], " ", 
        SubscriptBox["\[Gamma]", "2"]}], "-", 
       RowBox[{"18", " ", 
        SubscriptBox["u", "0"], " ", 
        SubscriptBox["\[Gamma]", "2"]}], "+", 
       RowBox[{"6", " ", 
        SubscriptBox["u", "1"], " ", 
        SubscriptBox["\[Gamma]", "2"]}]}], 
      RowBox[{
       RowBox[{"6", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]]}], "-", 
       RowBox[{"24", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "+", 
       RowBox[{"36", " ", 
        SubscriptBox["u", "0"]}], "-", 
       RowBox[{"24", " ", 
        SubscriptBox["u", "1"]}], "+", 
       RowBox[{"6", " ", 
        SubscriptBox["u", "2"]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.5726079010248165`*^9, 3.5726079171247373`*^9}, 
   3.5726086408901343`*^9, 3.5726096493138127`*^9, 3.5943440603791933`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "using", " ", "matrix", " ", "linear", " ", "system", " ", "to", " ", 
   "solve", " ", "this", " ", 
   RowBox[{"equation", ":"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5726079332656603`*^9, 3.572607982317466*^9}, {
  3.583040526695909*^9, 3.583040575520376*^9}, {3.583109688895068*^9, 
  3.58310971268511*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientTable", "[", 
   RowBox[{"r", ",", 
    RowBox[{"o", "[", 
     RowBox[{"r", ",", "d"}], "]"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientTable", "[", 
   RowBox[{"r", ",", 
    RowBox[{"s", "[", 
     RowBox[{"r", ",", "d"}], "]"}]}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.5726079900529084`*^9, 3.5726080307022333`*^9}, 
   3.59434403933799*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox["1", 
        RowBox[{"12", " ", "\[CapitalDelta]x"}]]},
      {
       RowBox[{"-", 
        FractionBox["2", 
         RowBox[{"3", " ", "\[CapitalDelta]x"}]]}]},
      {"0"},
      {
       FractionBox["2", 
        RowBox[{"3", " ", "\[CapitalDelta]x"}]]},
      {
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"12", " ", "\[CapitalDelta]x"}]]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.572608036025538*^9, 3.57260864326627*^9, 3.5726096538180704`*^9, {
   3.594344040149036*^9, 3.5943440604261956`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", " ", "\[CapitalDelta]x"}]], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["2", "\[CapitalDelta]x"]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", "\[CapitalDelta]x"}]]}], "0"},
     {
      FractionBox["3", 
       RowBox[{"2", " ", "\[CapitalDelta]x"}]], "0", 
      RowBox[{"-", 
       FractionBox["3", 
        RowBox[{"2", " ", "\[CapitalDelta]x"}]]}]},
     {"0", 
      FractionBox["1", 
       RowBox[{"2", " ", "\[CapitalDelta]x"}]], 
      FractionBox["2", "\[CapitalDelta]x"]},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", "\[CapitalDelta]x"}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.572608036025538*^9, 3.57260864326627*^9, 3.5726096538180704`*^9, {
   3.594344040149036*^9, 3.594344060431196*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"LinearSolveWeights", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.572608078946993*^9, 3.572608141870592*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "6"], ",", 
   FractionBox["2", "3"], ",", 
   FractionBox["1", "6"]}], "}"}]], "Output",
 CellChangeTimes->{{3.5726081501360645`*^9, 3.5726081778376493`*^9}, 
   3.5726086481425495`*^9, 3.5726096565342255`*^9, 3.594344060478199*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.5726081501360645`*^9, 3.5726081778376493`*^9}, 
   3.5726086481425495`*^9, 3.5726096565342255`*^9, 3.594344060481199*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Second Derivate", "Subsection",
 CellChangeTimes->{{3.5726081876242085`*^9, 3.5726082348539104`*^9}, {
   3.572608272110041*^9, 3.572608272845083*^9}, {3.5726085572323494`*^9, 
   3.5726085615895987`*^9}, {3.5726091675902596`*^9, 3.5726091685163126`*^9}, 
   3.583042726845765*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "=", " ", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.5726082777103615`*^9, 3.5726082788454266`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Display", " ", "the", " ", "optimal", " ", "5"}], "-", 
    RowBox[{
    "point", " ", "stencil", "  ", "coefficients", " ", "for", " ", "the", 
     " ", "derivate"}]}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "3"}], "-", 
    RowBox[{"point", " ", "substencil", " ", "coefficients"}]}], ",", " ", 
   RowBox[{
   "and", " ", "the", " ", "linear", " ", "weights", " ", "necessary", " ", 
    "to", " ", "recover", " ", "the", " ", "maximun", " ", "order", " ", "of",
     " ", "accuaracy"}]}], " ", "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"o", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", " ", 
  RowBox[{"Optimal", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"Contributions", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}]}], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    SubscriptBox["u", 
     RowBox[{"-", "2"}]]}], "+", 
   RowBox[{"16", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "1"}]]}], "-", 
   RowBox[{"30", " ", 
    SubscriptBox["u", "0"]}], "+", 
   RowBox[{"16", " ", 
    SubscriptBox["u", "1"]}], "-", 
   SubscriptBox["u", "2"]}], 
  RowBox[{"12", " ", 
   SuperscriptBox["\[CapitalDelta]x", "2"]}]]], "Output",
 CellChangeTimes->{3.5726082371930437`*^9, 3.57260828502378*^9, 
  3.572608654029886*^9, 3.5726096651817207`*^9, 3.594344060518201*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "2"}]], "-", 
     RowBox[{"2", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     SubscriptBox["u", "0"]}], 
    SuperscriptBox["\[CapitalDelta]x", "2"]], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "1"}]], "-", 
     RowBox[{"2", " ", 
      SubscriptBox["u", "0"]}], "+", 
     SubscriptBox["u", "1"]}], 
    SuperscriptBox["\[CapitalDelta]x", "2"]], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", "0"], "-", 
     RowBox[{"2", " ", 
      SubscriptBox["u", "1"]}], "+", 
     SubscriptBox["u", "2"]}], 
    SuperscriptBox["\[CapitalDelta]x", "2"]]}], "}"}]], "Output",
 CellChangeTimes->{3.5726082371930437`*^9, 3.57260828502378*^9, 
  3.572608654029886*^9, 3.5726096651817207`*^9, 3.594344060521201*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"LinearSolveWeights", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5726082513818555`*^9, 3.5726082521498995`*^9}, 
   3.572608292799225*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "12"]}], ",", 
   FractionBox["7", "6"], ",", 
   RowBox[{"-", 
    FractionBox["1", "12"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.572608252579924*^9, 3.572608293783281*^9, 
  3.572608656464025*^9, 3.5726096686089163`*^9, 3.594344060551203*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.572608252579924*^9, 3.572608293783281*^9, 
  3.572608656464025*^9, 3.5726096686089163`*^9, 3.594344060554203*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Smoothness indicators", "Subsection",
 CellChangeTimes->{{3.572608573799297*^9, 3.5726085824297905`*^9}, {
   3.572608663981455*^9, 3.572608665221526*^9}, {3.572609605982334*^9, 
   3.5726096087414923`*^9}, 3.583042731403046*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StencilSmoothness", "[", 
      RowBox[{"r", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "r"}], "}"}]}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SubsuperscriptBox["u", 
            RowBox[{"-", "2"}], "2"]}], "+", 
          RowBox[{"25", " ", 
           SubsuperscriptBox["u", 
            RowBox[{"-", "1"}], "2"]}], "-", 
          RowBox[{"31", " ", 
           SubscriptBox["u", 
            RowBox[{"-", "1"}]], " ", 
           SubscriptBox["u", "0"]}], "+", 
          RowBox[{"10", " ", 
           SubsuperscriptBox["u", "0", "2"]}], "+", 
          RowBox[{
           SubscriptBox["u", 
            RowBox[{"-", "2"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "19"}], " ", 
              SubscriptBox["u", 
               RowBox[{"-", "1"}]]}], "+", 
             RowBox[{"11", " ", 
              SubscriptBox["u", "0"]}]}], ")"}]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SubsuperscriptBox["u", 
            RowBox[{"-", "1"}], "2"]}], "+", 
          RowBox[{"13", " ", 
           SubsuperscriptBox["u", "0", "2"]}], "-", 
          RowBox[{"13", " ", 
           SubscriptBox["u", "0"], " ", 
           SubscriptBox["u", "1"]}], "+", 
          RowBox[{"4", " ", 
           SubsuperscriptBox["u", "1", "2"]}], "+", 
          RowBox[{
           SubscriptBox["u", 
            RowBox[{"-", "1"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "13"}], " ", 
              SubscriptBox["u", "0"]}], "+", 
             RowBox[{"5", " ", 
              SubscriptBox["u", "1"]}]}], ")"}]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"10", " ", 
           SubsuperscriptBox["u", "0", "2"]}], "+", 
          RowBox[{"25", " ", 
           SubsuperscriptBox["u", "1", "2"]}], "-", 
          RowBox[{"19", " ", 
           SubscriptBox["u", "1"], " ", 
           SubscriptBox["u", "2"]}], "+", 
          RowBox[{"4", " ", 
           SubsuperscriptBox["u", "2", "2"]}], "+", 
          RowBox[{
           SubscriptBox["u", "0"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "31"}], " ", 
              SubscriptBox["u", "1"]}], "+", 
             RowBox[{"11", " ", 
              SubscriptBox["u", "2"]}]}], ")"}]}]}], ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.572609612127686*^9, 3.572609672481138*^9, 
  3.5943440606552086`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     SubscriptBox["IS", 
      RowBox[{"j", "-", "1"}]], "==", 
     RowBox[{"StencilSmoothness", "[", 
      RowBox[{"r", ",", "j"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "r"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.572608666988627*^9, 3.5726087175425186`*^9}, {
  3.572609505126566*^9, 3.5726095612787776`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "0"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "2"}], "2"]}], "-", 
     RowBox[{"19", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"25", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "1"}], "2"]}], "+", 
     RowBox[{"11", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", "0"]}], "-", 
     RowBox[{"31", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"10", " ", 
      SubsuperscriptBox["u", "0", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.572609564675972*^9, 3.5726096769853954`*^9, 
  3.594344060703212*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "1"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "1"}], "2"]}], "-", 
     RowBox[{"13", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"13", " ", 
      SubsuperscriptBox["u", "0", "2"]}], "+", 
     RowBox[{"5", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "1"]}], "-", 
     RowBox[{"13", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"4", " ", 
      SubsuperscriptBox["u", "1", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.572609564675972*^9, 3.5726096769853954`*^9, 
  3.5943440607192125`*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "2"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"10", " ", 
      SubsuperscriptBox["u", "0", "2"]}], "-", 
     RowBox[{"31", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"25", " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{"11", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "2"]}], "-", 
     RowBox[{"19", " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"4", " ", 
      SubsuperscriptBox["u", "2", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.572609564675972*^9, 3.5726096769853954`*^9, 
  3.594344060749214*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "These", " ", "smoothness", " ", "indicators", " ", "may", " ", "be", " ",
      "factores", " ", "as", " ", "in", " ", 
     RowBox[{"ref", "[", "2", "]"}]}], ",", " ", 
    RowBox[{"equations", " ", 
     RowBox[{"(", "3.2", ")"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", ",", "3"}], ")"}], " ", "and", " ", 
     RowBox[{"(", 
      RowBox[{"3", ",", "4"}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "by", " ", "using", " ", "Horner", " ", "Factorization", " ", "on", " ", 
    "the", " ", "indicators", " ", "we", " ", "may", " ", "also", " ", 
    "reduce", " ", "their", " ", "computational", " ", "complexity"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5726087229928303`*^9, 3.572608771149585*^9}, {
  3.5726088347112203`*^9, 3.572608882069929*^9}, {3.583043326561552*^9, 
  3.58304336049047*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"SmoothnessFactor", "[", 
     RowBox[{"r", ",", 
      RowBox[{"StencilSmoothness", "[", 
       RowBox[{"r", ",", "j"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "r"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.572608884797085*^9, 3.5726089223412323`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         FractionBox["1", "3"], " ", 
         SubscriptBox["u", 
          RowBox[{"-", "1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"25", " ", 
            SubscriptBox["u", 
             RowBox[{"-", "1"}]]}], "-", 
           RowBox[{"31", " ", 
            SubscriptBox["u", "0"]}]}], ")"}]}], "+", 
        FractionBox[
         RowBox[{"10", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "3"], "+", 
        RowBox[{
         FractionBox["1", "3"], " ", 
         SubscriptBox["u", 
          RowBox[{"-", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SubscriptBox["u", 
             RowBox[{"-", "2"}]]}], "-", 
           RowBox[{"19", " ", 
            SubscriptBox["u", 
             RowBox[{"-", "1"}]]}], "+", 
           RowBox[{"11", " ", 
            SubscriptBox["u", "0"]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         FractionBox["13", "3"], " ", 
         SubscriptBox["u", "0"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["u", "0"], "-", 
           SubscriptBox["u", "1"]}], ")"}]}], "+", 
        FractionBox[
         RowBox[{"4", " ", 
          SubsuperscriptBox["u", "1", "2"]}], "3"], "+", 
        RowBox[{
         FractionBox["1", "3"], " ", 
         SubscriptBox["u", 
          RowBox[{"-", "1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SubscriptBox["u", 
             RowBox[{"-", "1"}]]}], "-", 
           RowBox[{"13", " ", 
            SubscriptBox["u", "0"]}], "+", 
           RowBox[{"5", " ", 
            SubscriptBox["u", "1"]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         FractionBox["1", "3"], " ", 
         SubscriptBox["u", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"25", " ", 
            SubscriptBox["u", "1"]}], "-", 
           RowBox[{"19", " ", 
            SubscriptBox["u", "2"]}]}], ")"}]}], "+", 
        FractionBox[
         RowBox[{"4", " ", 
          SubsuperscriptBox["u", "2", "2"]}], "3"], "+", 
        RowBox[{
         FractionBox["1", "3"], " ", 
         SubscriptBox["u", "0"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"10", " ", 
            SubscriptBox["u", "0"]}], "-", 
           RowBox[{"31", " ", 
            SubscriptBox["u", "1"]}], "+", 
           RowBox[{"11", " ", 
            SubscriptBox["u", "2"]}]}], ")"}]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.5726089251473927`*^9, 3.59434406084822*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     SubscriptBox["IS", 
      RowBox[{"j", "-", "1"}]], "==", 
     RowBox[{"SmoothnessFactor", "[", 
      RowBox[{"r", ",", 
       RowBox[{"StencilSmoothness", "[", 
        RowBox[{"r", ",", "j"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "r"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.57260972759229*^9, 3.5726097399509974`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "0"], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "3"], " ", 
    SubscriptBox["u", 
     RowBox[{"-", "1"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"25", " ", 
       SubscriptBox["u", 
        RowBox[{"-", "1"}]]}], "-", 
      RowBox[{"31", " ", 
       SubscriptBox["u", "0"]}]}], ")"}]}], "+", 
   FractionBox[
    RowBox[{"10", " ", 
     SubsuperscriptBox["u", "0", "2"]}], "3"], "+", 
   RowBox[{
    FractionBox["1", "3"], " ", 
    SubscriptBox["u", 
     RowBox[{"-", "2"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SubscriptBox["u", 
        RowBox[{"-", "2"}]]}], "-", 
      RowBox[{"19", " ", 
       SubscriptBox["u", 
        RowBox[{"-", "1"}]]}], "+", 
      RowBox[{"11", " ", 
       SubscriptBox["u", "0"]}]}], ")"}]}]}]}]], "Print",
 CellChangeTimes->{3.572609741138065*^9, 3.5943440608942223`*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "1"], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox["13", "3"], " ", 
    SubscriptBox["u", "0"], " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["u", "0"], "-", 
      SubscriptBox["u", "1"]}], ")"}]}], "+", 
   FractionBox[
    RowBox[{"4", " ", 
     SubsuperscriptBox["u", "1", "2"]}], "3"], "+", 
   RowBox[{
    FractionBox["1", "3"], " ", 
    SubscriptBox["u", 
     RowBox[{"-", "1"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SubscriptBox["u", 
        RowBox[{"-", "1"}]]}], "-", 
      RowBox[{"13", " ", 
       SubscriptBox["u", "0"]}], "+", 
      RowBox[{"5", " ", 
       SubscriptBox["u", "1"]}]}], ")"}]}]}]}]], "Print",
 CellChangeTimes->{3.572609741138065*^9, 3.594344060912224*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "2"], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "3"], " ", 
    SubscriptBox["u", "1"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"25", " ", 
       SubscriptBox["u", "1"]}], "-", 
      RowBox[{"19", " ", 
       SubscriptBox["u", "2"]}]}], ")"}]}], "+", 
   FractionBox[
    RowBox[{"4", " ", 
     SubsuperscriptBox["u", "2", "2"]}], "3"], "+", 
   RowBox[{
    FractionBox["1", "3"], " ", 
    SubscriptBox["u", "0"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"10", " ", 
       SubscriptBox["u", "0"]}], "-", 
      RowBox[{"31", " ", 
       SubscriptBox["u", "1"]}], "+", 
      RowBox[{"11", " ", 
       SubscriptBox["u", "2"]}]}], ")"}]}]}]}]], "Print",
 CellChangeTimes->{3.572609741138065*^9, 3.5943440609352245`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

7-Point WENO derivate stencils\
\>", "Section",
 CellChangeTimes->{{3.572609962310715*^9, 3.572609971972268*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.5726089622045126`*^9, 3.572608982405668*^9}, {
  3.5726090992053485`*^9, 3.572609099989393*^9}}],

Cell[CellGroupData[{

Cell["First Derivate", "Subsection",
 CellChangeTimes->{{3.5726089840787635`*^9, 3.5726089840797634`*^9}, 
   3.583042815876021*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.5726089864699*^9, 3.5726090004927025`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Display", " ", "the", " ", "optimal", " ", "7"}], "-", 
    RowBox[{
    "point", " ", "stencil", "  ", "coefficients", " ", "for", " ", "the", 
     " ", "derivate"}]}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "4"}], "-", 
    RowBox[{"point", " ", "substencil", " ", "coefficients"}]}], ",", " ", 
   RowBox[{
   "and", " ", "the", " ", "linear", " ", "weights", " ", "necessary", " ", 
    "to", " ", "recover", " ", "the", " ", "maximun", " ", "order", " ", "of",
     " ", "accuaracy"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5726090035738783`*^9, 3.5726090068450656`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"o", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", " ", 
  RowBox[{"Optimal", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"Contributions", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoefficientTable", "[", 
    RowBox[{"r", ",", 
     RowBox[{"s", "[", 
      RowBox[{"r", ",", "d"}], "]"}]}], "]"}], " ", "//", "Transpose"}], " ", 
  "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.5726090590380507`*^9, 3.5726090901898327`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    SubscriptBox["u", 
     RowBox[{"-", "3"}]]}], "+", 
   RowBox[{"9", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "2"}]]}], "-", 
   RowBox[{"45", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "1"}]]}], "+", 
   RowBox[{"45", " ", 
    SubscriptBox["u", "1"]}], "-", 
   RowBox[{"9", " ", 
    SubscriptBox["u", "2"]}], "+", 
   SubscriptBox["u", "3"]}], 
  RowBox[{"60", " ", "\[CapitalDelta]x"}]]], "Output",
 CellChangeTimes->{{3.5726090929089885`*^9, 3.5726091041186295`*^9}, 
   3.572609773069891*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]]}], "+", 
     RowBox[{"9", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]]}], "-", 
     RowBox[{"18", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"11", " ", 
      SubscriptBox["u", "0"]}]}], 
    RowBox[{"6", " ", "\[CapitalDelta]x"}]], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "2"}]], "-", 
     RowBox[{"6", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"3", " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"2", " ", 
      SubscriptBox["u", "1"]}]}], 
    RowBox[{"6", " ", "\[CapitalDelta]x"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "-", 
     RowBox[{"3", " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"6", " ", 
      SubscriptBox["u", "1"]}], "-", 
     SubscriptBox["u", "2"]}], 
    RowBox[{"6", " ", "\[CapitalDelta]x"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "11"}], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"18", " ", 
      SubscriptBox["u", "1"]}], "-", 
     RowBox[{"9", " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"2", " ", 
      SubscriptBox["u", "3"]}]}], 
    RowBox[{"6", " ", "\[CapitalDelta]x"}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.5726090929089885`*^9, 3.5726091041186295`*^9}, 
   3.572609773080892*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"3", " ", "\[CapitalDelta]x"}]]}], 
      FractionBox["3", 
       RowBox[{"2", " ", "\[CapitalDelta]x"}]], 
      RowBox[{"-", 
       FractionBox["3", "\[CapitalDelta]x"]}], 
      FractionBox["11", 
       RowBox[{"6", " ", "\[CapitalDelta]x"}]], "0", "0", "0"},
     {"0", 
      FractionBox["1", 
       RowBox[{"6", " ", "\[CapitalDelta]x"}]], 
      RowBox[{"-", 
       FractionBox["1", "\[CapitalDelta]x"]}], 
      FractionBox["1", 
       RowBox[{"2", " ", "\[CapitalDelta]x"}]], 
      FractionBox["1", 
       RowBox[{"3", " ", "\[CapitalDelta]x"}]], "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"3", " ", "\[CapitalDelta]x"}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", "\[CapitalDelta]x"}]]}], 
      FractionBox["1", "\[CapitalDelta]x"], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"6", " ", "\[CapitalDelta]x"}]]}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["11", 
        RowBox[{"6", " ", "\[CapitalDelta]x"}]]}], 
      FractionBox["3", "\[CapitalDelta]x"], 
      RowBox[{"-", 
       FractionBox["3", 
        RowBox[{"2", " ", "\[CapitalDelta]x"}]]}], 
      FractionBox["1", 
       RowBox[{"3", " ", "\[CapitalDelta]x"}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5726090929089885`*^9, 3.5726091041186295`*^9}, 
   3.572609773083892*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "using", " ", "matrix", " ", "linear", " ", "system", " ", "to", " ", 
   "solve", " ", "this", " ", 
   RowBox[{"equation", ":"}]}], " ", "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"LinearSolveWeights", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.57260911252311*^9, 3.572609137486538*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "20"], ",", 
   FractionBox["9", "20"], ",", 
   FractionBox["9", "20"], ",", 
   FractionBox["1", "20"]}], "}"}]], "Output",
 CellChangeTimes->{3.5726091393376436`*^9, 3.5726097758190484`*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.5726091393376436`*^9, 3.572609775822049*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Second Derivate", "Subsection",
 CellChangeTimes->{{3.5726091736536064`*^9, 3.5726091743176446`*^9}, 
   3.583042821117112*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"No", " ", "full"}], "-", 
     RowBox[{"accuaracy", " ", "WENO"}], "-", 
     RowBox[{
     "based", " ", "second", " ", "derivate", " ", "exist", " ", "for", " ", 
      "the", " ", "r"}]}], "=", 
    RowBox[{
    "4", " ", "case", " ", "with", " ", "these", " ", "substencils"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "second", " ", "and", " ", "third", " ", "substencils", " ", 
    "are", " ", "identical", " ", "and", " ", "so", " ", "the", " ", 
    "resulting", " ", "weigth", " ", "problem", " ", "has", " ", "no", " ", 
    RowBox[{"solution", ".", " ", "Moreover"}], " ", "the", " ", "repeated", 
    " ", "substencil", " ", "usage", " ", "makes", " ", "it", " ", "unlikely",
     " ", "that", " ", "a", " ", "general", " ", "point", " ", 
    "discontinuity", " ", "can", " ", "be", " ", "circumnavigated", " ", "by",
     " ", "the", " ", "scheme"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5726091907745857`*^9, 3.572609198325018*^9}, {
  3.572609263213729*^9, 3.5726093805734415`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Smoothness indicators", "Subsection",
 CellChangeTimes->{3.583042824513208*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StencilSmoothness", "[", 
      RowBox[{"r", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "r"}], "}"}]}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{"6649", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "3"}], "2"]}], "+", 
         RowBox[{"85641", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "2"}], "2"]}], "+", 
         RowBox[{"134241", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "1"}], "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "3"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "47214"}], " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "+", 
            RowBox[{"56694", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"22778", " ", 
             SubscriptBox["u", "0"]}]}], ")"}]}], "-", 
         RowBox[{"114894", " ", 
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["u", "0"]}], "+", 
         RowBox[{"25729", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "210282"}], " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "+", 
            RowBox[{"86214", " ", 
             SubscriptBox["u", "0"]}]}], ")"}]}]}], "2880"]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"3169", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "2"}], "2"]}], "+", 
         RowBox[{"33441", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "1"}], "2"]}], "+", 
         RowBox[{"41001", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "-", 
         RowBox[{"30414", " ", 
          SubscriptBox["u", "0"], " ", 
          SubscriptBox["u", "1"]}], "+", 
         RowBox[{"6649", " ", 
          SubsuperscriptBox["u", "1", "2"]}], "-", 
         RowBox[{"2", " ", 
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9687", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"9507", " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"2989", " ", 
             SubscriptBox["u", "1"]}]}], ")"}]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "70602"}], " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"23094", " ", 
             SubscriptBox["u", "1"]}]}], ")"}]}]}], "2880"]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"6649", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "1"}], "2"]}], "+", 
         RowBox[{"41001", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "+", 
         RowBox[{"33441", " ", 
          SubsuperscriptBox["u", "1", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "30414"}], " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"23094", " ", 
             SubscriptBox["u", "1"]}], "-", 
            RowBox[{"5978", " ", 
             SubscriptBox["u", "2"]}]}], ")"}]}], "-", 
         RowBox[{"19374", " ", 
          SubscriptBox["u", "1"], " ", 
          SubscriptBox["u", "2"]}], "+", 
         RowBox[{"3169", " ", 
          SubsuperscriptBox["u", "2", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", "0"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "70602"}], " ", 
             SubscriptBox["u", "1"]}], "+", 
            RowBox[{"19014", " ", 
             SubscriptBox["u", "2"]}]}], ")"}]}]}], "2880"]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"25729", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "+", 
         RowBox[{"134241", " ", 
          SubsuperscriptBox["u", "1", "2"]}], "+", 
         RowBox[{"85641", " ", 
          SubsuperscriptBox["u", "2", "2"]}], "-", 
         RowBox[{"6", " ", 
          SubscriptBox["u", "1"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"35047", " ", 
             SubscriptBox["u", "2"]}], "-", 
            RowBox[{"9449", " ", 
             SubscriptBox["u", "3"]}]}], ")"}]}], "-", 
         RowBox[{"47214", " ", 
          SubscriptBox["u", "2"], " ", 
          SubscriptBox["u", "3"]}], "+", 
         RowBox[{"6649", " ", 
          SubsuperscriptBox["u", "3", "2"]}], "-", 
         RowBox[{"2", " ", 
          SubscriptBox["u", "0"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"57447", " ", 
             SubscriptBox["u", "1"]}], "-", 
            RowBox[{"43107", " ", 
             SubscriptBox["u", "2"]}], "+", 
            RowBox[{"11389", " ", 
             SubscriptBox["u", "3"]}]}], ")"}]}]}], "2880"]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.5726097787432156`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     SubscriptBox["IS", 
      RowBox[{"j", "-", "1"}]], "==", 
     RowBox[{"StencilSmoothness", "[", 
      RowBox[{"r", ",", "j"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "r"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "0"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "2880"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"6649", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "3"}], "2"]}], "-", 
     RowBox[{"47214", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]]}], "+", 
     RowBox[{"85641", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "2"}], "2"]}], "+", 
     RowBox[{"56694", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "-", 
     RowBox[{"210282", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"134241", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "1"}], "2"]}], "-", 
     RowBox[{"22778", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"86214", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", "0"]}], "-", 
     RowBox[{"114894", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"25729", " ", 
      SubsuperscriptBox["u", "0", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.572609798359338*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "1"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "2880"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3169", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "2"}], "2"]}], "-", 
     RowBox[{"19374", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"33441", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "1"}], "2"]}], "+", 
     RowBox[{"19014", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", "0"]}], "-", 
     RowBox[{"70602", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"41001", " ", 
      SubsuperscriptBox["u", "0", "2"]}], "-", 
     RowBox[{"5978", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"23094", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "1"]}], "-", 
     RowBox[{"30414", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"6649", " ", 
      SubsuperscriptBox["u", "1", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.572609798417341*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "2"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "2880"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"6649", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "1"}], "2"]}], "-", 
     RowBox[{"30414", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"41001", " ", 
      SubsuperscriptBox["u", "0", "2"]}], "+", 
     RowBox[{"23094", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "1"]}], "-", 
     RowBox[{"70602", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"33441", " ", 
      SubsuperscriptBox["u", "1", "2"]}], "-", 
     RowBox[{"5978", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"19014", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "2"]}], "-", 
     RowBox[{"19374", " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"3169", " ", 
      SubsuperscriptBox["u", "2", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.572609798470344*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "3"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "2880"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"25729", " ", 
      SubsuperscriptBox["u", "0", "2"]}], "-", 
     RowBox[{"114894", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"134241", " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{"86214", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "2"]}], "-", 
     RowBox[{"210282", " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"85641", " ", 
      SubsuperscriptBox["u", "2", "2"]}], "-", 
     RowBox[{"22778", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "3"]}], "+", 
     RowBox[{"56694", " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "3"]}], "-", 
     RowBox[{"47214", " ", 
      SubscriptBox["u", "2"], " ", 
      SubscriptBox["u", "3"]}], "+", 
     RowBox[{"6649", " ", 
      SubsuperscriptBox["u", "3", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.572609798526347*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"SmoothnessFactor", "[", 
     RowBox[{"r", ",", 
      RowBox[{"StencilSmoothness", "[", 
       RowBox[{"r", ",", "j"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "r"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         FractionBox["1", "960"], " ", 
         SubscriptBox["u", 
          RowBox[{"-", "1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"44747", " ", 
            SubscriptBox["u", 
             RowBox[{"-", "1"}]]}], "-", 
           RowBox[{"38298", " ", 
            SubscriptBox["u", "0"]}]}], ")"}]}], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "3"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6649", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "3"}]]}], "-", 
            RowBox[{"47214", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "+", 
            RowBox[{"56694", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"22778", " ", 
             SubscriptBox["u", "0"]}]}], ")"}]}], "2880"], "+", 
        FractionBox[
         RowBox[{"25729", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "2880"], "+", 
        RowBox[{
         FractionBox["1", "960"], " ", 
         SubscriptBox["u", 
          RowBox[{"-", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"28547", " ", 
            SubscriptBox["u", 
             RowBox[{"-", "2"}]]}], "-", 
           RowBox[{"70094", " ", 
            SubscriptBox["u", 
             RowBox[{"-", "1"}]]}], "+", 
           RowBox[{"28738", " ", 
            SubscriptBox["u", "0"]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         FractionBox["1", "960"], " ", 
         SubscriptBox["u", "0"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"13667", " ", 
            SubscriptBox["u", "0"]}], "-", 
           RowBox[{"10138", " ", 
            SubscriptBox["u", "1"]}]}], ")"}]}], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3169", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "-", 
            RowBox[{"19374", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "+", 
            RowBox[{"19014", " ", 
             SubscriptBox["u", "0"]}], "-", 
            RowBox[{"5978", " ", 
             SubscriptBox["u", "1"]}]}], ")"}]}], "2880"], "+", 
        FractionBox[
         RowBox[{"6649", " ", 
          SubsuperscriptBox["u", "1", "2"]}], "2880"], "+", 
        RowBox[{
         FractionBox["1", "960"], " ", 
         SubscriptBox["u", 
          RowBox[{"-", "1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"11147", " ", 
            SubscriptBox["u", 
             RowBox[{"-", "1"}]]}], "-", 
           RowBox[{"23534", " ", 
            SubscriptBox["u", "0"]}], "+", 
           RowBox[{"7698", " ", 
            SubscriptBox["u", "1"]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         FractionBox["1", "960"], " ", 
         SubscriptBox["u", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"11147", " ", 
            SubscriptBox["u", "1"]}], "-", 
           RowBox[{"6458", " ", 
            SubscriptBox["u", "2"]}]}], ")"}]}], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6649", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"30414", " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"23094", " ", 
             SubscriptBox["u", "1"]}], "-", 
            RowBox[{"5978", " ", 
             SubscriptBox["u", "2"]}]}], ")"}]}], "2880"], "+", 
        FractionBox[
         RowBox[{"3169", " ", 
          SubsuperscriptBox["u", "2", "2"]}], "2880"], "+", 
        RowBox[{
         FractionBox["1", "960"], " ", 
         SubscriptBox["u", "0"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"13667", " ", 
            SubscriptBox["u", "0"]}], "-", 
           RowBox[{"23534", " ", 
            SubscriptBox["u", "1"]}], "+", 
           RowBox[{"6338", " ", 
            SubscriptBox["u", "2"]}]}], ")"}]}]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["u", "0"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"25729", " ", 
             SubscriptBox["u", "0"]}], "-", 
            RowBox[{"114894", " ", 
             SubscriptBox["u", "1"]}], "+", 
            RowBox[{"86214", " ", 
             SubscriptBox["u", "2"]}], "-", 
            RowBox[{"22778", " ", 
             SubscriptBox["u", "3"]}]}], ")"}]}], "2880"], "+", 
        RowBox[{
         FractionBox["1", "960"], " ", 
         SubscriptBox["u", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"28547", " ", 
            SubscriptBox["u", "2"]}], "-", 
           RowBox[{"15738", " ", 
            SubscriptBox["u", "3"]}]}], ")"}]}], "+", 
        FractionBox[
         RowBox[{"6649", " ", 
          SubsuperscriptBox["u", "3", "2"]}], "2880"], "+", 
        RowBox[{
         FractionBox["1", "960"], " ", 
         SubscriptBox["u", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"44747", " ", 
            SubscriptBox["u", "1"]}], "-", 
           RowBox[{"70094", " ", 
            SubscriptBox["u", "2"]}], "+", 
           RowBox[{"18898", " ", 
            SubscriptBox["u", "3"]}]}], ")"}]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.572609811524091*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     SubscriptBox["IS", 
      RowBox[{"j", "-", "1"}]], "==", 
     RowBox[{"SmoothnessFactor", "[", 
      RowBox[{"r", ",", 
       RowBox[{"StencilSmoothness", "[", 
        RowBox[{"r", ",", "j"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "r"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "0"], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "960"], " ", 
    SubscriptBox["u", 
     RowBox[{"-", "1"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"44747", " ", 
       SubscriptBox["u", 
        RowBox[{"-", "1"}]]}], "-", 
      RowBox[{"38298", " ", 
       SubscriptBox["u", "0"]}]}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "3"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6649", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "3"}]]}], "-", 
       RowBox[{"47214", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]]}], "+", 
       RowBox[{"56694", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "-", 
       RowBox[{"22778", " ", 
        SubscriptBox["u", "0"]}]}], ")"}]}], "2880"], "+", 
   FractionBox[
    RowBox[{"25729", " ", 
     SubsuperscriptBox["u", "0", "2"]}], "2880"], "+", 
   RowBox[{
    FractionBox["1", "960"], " ", 
    SubscriptBox["u", 
     RowBox[{"-", "2"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"28547", " ", 
       SubscriptBox["u", 
        RowBox[{"-", "2"}]]}], "-", 
      RowBox[{"70094", " ", 
       SubscriptBox["u", 
        RowBox[{"-", "1"}]]}], "+", 
      RowBox[{"28738", " ", 
       SubscriptBox["u", "0"]}]}], ")"}]}]}]}]], "Print",
 CellChangeTimes->{3.572609823854796*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "1"], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "960"], " ", 
    SubscriptBox["u", "0"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"13667", " ", 
       SubscriptBox["u", "0"]}], "-", 
      RowBox[{"10138", " ", 
       SubscriptBox["u", "1"]}]}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "2"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3169", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]]}], "-", 
       RowBox[{"19374", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "+", 
       RowBox[{"19014", " ", 
        SubscriptBox["u", "0"]}], "-", 
       RowBox[{"5978", " ", 
        SubscriptBox["u", "1"]}]}], ")"}]}], "2880"], "+", 
   FractionBox[
    RowBox[{"6649", " ", 
     SubsuperscriptBox["u", "1", "2"]}], "2880"], "+", 
   RowBox[{
    FractionBox["1", "960"], " ", 
    SubscriptBox["u", 
     RowBox[{"-", "1"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"11147", " ", 
       SubscriptBox["u", 
        RowBox[{"-", "1"}]]}], "-", 
      RowBox[{"23534", " ", 
       SubscriptBox["u", "0"]}], "+", 
      RowBox[{"7698", " ", 
       SubscriptBox["u", "1"]}]}], ")"}]}]}]}]], "Print",
 CellChangeTimes->{3.5726098239157996`*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "2"], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "960"], " ", 
    SubscriptBox["u", "1"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"11147", " ", 
       SubscriptBox["u", "1"]}], "-", 
      RowBox[{"6458", " ", 
       SubscriptBox["u", "2"]}]}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "1"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6649", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "-", 
       RowBox[{"30414", " ", 
        SubscriptBox["u", "0"]}], "+", 
       RowBox[{"23094", " ", 
        SubscriptBox["u", "1"]}], "-", 
       RowBox[{"5978", " ", 
        SubscriptBox["u", "2"]}]}], ")"}]}], "2880"], "+", 
   FractionBox[
    RowBox[{"3169", " ", 
     SubsuperscriptBox["u", "2", "2"]}], "2880"], "+", 
   RowBox[{
    FractionBox["1", "960"], " ", 
    SubscriptBox["u", "0"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"13667", " ", 
       SubscriptBox["u", "0"]}], "-", 
      RowBox[{"23534", " ", 
       SubscriptBox["u", "1"]}], "+", 
      RowBox[{"6338", " ", 
       SubscriptBox["u", "2"]}]}], ")"}]}]}]}]], "Print",
 CellChangeTimes->{3.5726098239718027`*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "3"], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox["u", "0"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"25729", " ", 
        SubscriptBox["u", "0"]}], "-", 
       RowBox[{"114894", " ", 
        SubscriptBox["u", "1"]}], "+", 
       RowBox[{"86214", " ", 
        SubscriptBox["u", "2"]}], "-", 
       RowBox[{"22778", " ", 
        SubscriptBox["u", "3"]}]}], ")"}]}], "2880"], "+", 
   RowBox[{
    FractionBox["1", "960"], " ", 
    SubscriptBox["u", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"28547", " ", 
       SubscriptBox["u", "2"]}], "-", 
      RowBox[{"15738", " ", 
       SubscriptBox["u", "3"]}]}], ")"}]}], "+", 
   FractionBox[
    RowBox[{"6649", " ", 
     SubsuperscriptBox["u", "3", "2"]}], "2880"], "+", 
   RowBox[{
    FractionBox["1", "960"], " ", 
    SubscriptBox["u", "1"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"44747", " ", 
       SubscriptBox["u", "1"]}], "-", 
      RowBox[{"70094", " ", 
       SubscriptBox["u", "2"]}], "+", 
      RowBox[{"18898", " ", 
       SubscriptBox["u", "3"]}]}], ")"}]}]}]}]], "Print",
 CellChangeTimes->{3.572609824029806*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\

9-Point WENO derivate stencils\
\>", "Section",
 CellChangeTimes->{{3.5726098651101556`*^9, 3.572609874044667*^9}, {
  3.5726099797317114`*^9, 3.572609980124734*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "=", "5"}], ";"}]], "Input",
 CellChangeTimes->{{3.572609985559045*^9, 3.5726100000048714`*^9}}],

Cell[CellGroupData[{

Cell["First Derivate", "Subsection",
 CellChangeTimes->{3.583042838731818*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", " ", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.572610005000157*^9, 3.5726100298295774`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Display", " ", "the", " ", "optimal", " ", "9"}], "-", 
    RowBox[{
    "point", " ", "stencil", "  ", "coefficients", " ", "for", " ", "the", 
     " ", "derivate"}]}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "5"}], "-", 
    RowBox[{"point", " ", "substencil", " ", "coefficients"}]}], ",", " ", 
   RowBox[{
   "and", " ", "the", " ", "linear", " ", "weights", " ", "necessary", " ", 
    "to", " ", "recover", " ", "the", " ", "maximun", " ", "order", " ", "of",
     " ", "accuaracy"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.572610033869808*^9, 3.5726100394851294`*^9}, 
   3.5726101031097684`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"o", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", " ", 
  RowBox[{"Optimal", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"Contributions", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoefficientTable", "[", 
    RowBox[{"r", ",", 
     RowBox[{"s", "[", 
      RowBox[{"r", ",", "d"}], "]"}]}], "]"}], " ", "//", "Transpose"}], " ", 
  "//", "MatrixForm"}]}], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"3", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "4"}]]}], "-", 
   RowBox[{"32", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "3"}]]}], "+", 
   RowBox[{"168", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "2"}]]}], "-", 
   RowBox[{"672", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "1"}]]}], "+", 
   RowBox[{"672", " ", 
    SubscriptBox["u", "1"]}], "-", 
   RowBox[{"168", " ", 
    SubscriptBox["u", "2"]}], "+", 
   RowBox[{"32", " ", 
    SubscriptBox["u", "3"]}], "-", 
   RowBox[{"3", " ", 
    SubscriptBox["u", "4"]}]}], 
  RowBox[{"840", " ", "\[CapitalDelta]x"}]]], "Output",
 CellChangeTimes->{{3.5726101055949106`*^9, 3.572610115484476*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"3", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "4"}]]}], "-", 
     RowBox[{"16", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]]}], "+", 
     RowBox[{"36", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]]}], "-", 
     RowBox[{"48", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"25", " ", 
      SubscriptBox["u", "0"]}]}], 
    RowBox[{"12", " ", "\[CapitalDelta]x"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]]}], "+", 
     RowBox[{"6", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]]}], "-", 
     RowBox[{"18", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"10", " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"3", " ", 
      SubscriptBox["u", "1"]}]}], 
    RowBox[{"12", " ", "\[CapitalDelta]x"}]], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "2"}]], "-", 
     RowBox[{"8", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"8", " ", 
      SubscriptBox["u", "1"]}], "-", 
     SubscriptBox["u", "2"]}], 
    RowBox[{"12", " ", "\[CapitalDelta]x"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "-", 
     RowBox[{"10", " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"18", " ", 
      SubscriptBox["u", "1"]}], "-", 
     RowBox[{"6", " ", 
      SubscriptBox["u", "2"]}], "+", 
     SubscriptBox["u", "3"]}], 
    RowBox[{"12", " ", "\[CapitalDelta]x"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "25"}], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"48", " ", 
      SubscriptBox["u", "1"]}], "-", 
     RowBox[{"36", " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"16", " ", 
      SubscriptBox["u", "3"]}], "-", 
     RowBox[{"3", " ", 
      SubscriptBox["u", "4"]}]}], 
    RowBox[{"12", " ", "\[CapitalDelta]x"}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.5726101055949106`*^9, 3.572610115686488*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"4", " ", "\[CapitalDelta]x"}]], 
      RowBox[{"-", 
       FractionBox["4", 
        RowBox[{"3", " ", "\[CapitalDelta]x"}]]}], 
      FractionBox["3", "\[CapitalDelta]x"], 
      RowBox[{"-", 
       FractionBox["4", "\[CapitalDelta]x"]}], 
      FractionBox["25", 
       RowBox[{"12", " ", "\[CapitalDelta]x"}]], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"12", " ", "\[CapitalDelta]x"}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", "\[CapitalDelta]x"}]], 
      RowBox[{"-", 
       FractionBox["3", 
        RowBox[{"2", " ", "\[CapitalDelta]x"}]]}], 
      FractionBox["5", 
       RowBox[{"6", " ", "\[CapitalDelta]x"}]], 
      FractionBox["1", 
       RowBox[{"4", " ", "\[CapitalDelta]x"}]], "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       RowBox[{"12", " ", "\[CapitalDelta]x"}]], 
      RowBox[{"-", 
       FractionBox["2", 
        RowBox[{"3", " ", "\[CapitalDelta]x"}]]}], "0", 
      FractionBox["2", 
       RowBox[{"3", " ", "\[CapitalDelta]x"}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"12", " ", "\[CapitalDelta]x"}]]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"4", " ", "\[CapitalDelta]x"}]]}], 
      RowBox[{"-", 
       FractionBox["5", 
        RowBox[{"6", " ", "\[CapitalDelta]x"}]]}], 
      FractionBox["3", 
       RowBox[{"2", " ", "\[CapitalDelta]x"}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", "\[CapitalDelta]x"}]]}], 
      FractionBox["1", 
       RowBox[{"12", " ", "\[CapitalDelta]x"}]], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["25", 
        RowBox[{"12", " ", "\[CapitalDelta]x"}]]}], 
      FractionBox["4", "\[CapitalDelta]x"], 
      RowBox[{"-", 
       FractionBox["3", "\[CapitalDelta]x"]}], 
      FractionBox["4", 
       RowBox[{"3", " ", "\[CapitalDelta]x"}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"4", " ", "\[CapitalDelta]x"}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5726101055949106`*^9, 3.572610115687488*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "using", " ", "matrix", " ", "linear", " ", "system", " ", "to", " ", 
   "solve", " ", "this", " ", 
   RowBox[{"equation", ":"}]}], " ", "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"LinearSolveWeights", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "70"], ",", 
   FractionBox["8", "35"], ",", 
   FractionBox["18", "35"], ",", 
   FractionBox["8", "35"], ",", 
   FractionBox["1", "70"]}], "}"}]], "Output",
 CellChangeTimes->{3.5726101342165475`*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.5726101342175474`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Second Derivate", "Subsection",
 CellChangeTimes->{{3.572610148477363*^9, 3.5726101500674543`*^9}, 
   3.583042843829281*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.572610153577655*^9, 3.572610177581028*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Display", " ", "the", " ", "optimal", " ", "9"}], "-", 
    RowBox[{
    "point", " ", "stencil", "  ", "coefficients", " ", "for", " ", "the", 
     " ", "derivate"}]}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "5"}], "-", 
    RowBox[{"point", " ", "substencil", " ", "coefficients"}]}], ",", " ", 
   RowBox[{
   "and", " ", "the", " ", "linear", " ", "weights", " ", "necessary", " ", 
    "to", " ", "recover", " ", "the", " ", "maximun", " ", "order", " ", "of",
     " ", "accuaracy"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.572610179765153*^9, 3.572610202936478*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"o", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", " ", 
  RowBox[{"Optimal", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"Contributions", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoefficientTable", "[", 
    RowBox[{"r", ",", 
     RowBox[{"s", "[", 
      RowBox[{"r", ",", "d"}], "]"}]}], "]"}], " ", "//", "Transpose"}], " ", 
  "//", "MatrixForm"}]}], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "9"}], " ", 
    SubscriptBox["u", 
     RowBox[{"-", "4"}]]}], "+", 
   RowBox[{"128", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "3"}]]}], "-", 
   RowBox[{"1008", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "2"}]]}], "+", 
   RowBox[{"8064", " ", 
    SubscriptBox["u", 
     RowBox[{"-", "1"}]]}], "-", 
   RowBox[{"14350", " ", 
    SubscriptBox["u", "0"]}], "+", 
   RowBox[{"8064", " ", 
    SubscriptBox["u", "1"]}], "-", 
   RowBox[{"1008", " ", 
    SubscriptBox["u", "2"]}], "+", 
   RowBox[{"128", " ", 
    SubscriptBox["u", "3"]}], "-", 
   RowBox[{"9", " ", 
    SubscriptBox["u", "4"]}]}], 
  RowBox[{"5040", " ", 
   SuperscriptBox["\[CapitalDelta]x", "2"]}]]], "Output",
 CellChangeTimes->{{3.5726102083637886`*^9, 3.572610236429394*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"11", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "4"}]]}], "-", 
     RowBox[{"56", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]]}], "+", 
     RowBox[{"114", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]]}], "-", 
     RowBox[{"104", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"35", " ", 
      SubscriptBox["u", "0"]}]}], 
    RowBox[{"12", " ", 
     SuperscriptBox["\[CapitalDelta]x", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]]}], "+", 
     RowBox[{"4", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]]}], "+", 
     RowBox[{"6", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "-", 
     RowBox[{"20", " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"11", " ", 
      SubscriptBox["u", "1"]}]}], 
    RowBox[{"12", " ", 
     SuperscriptBox["\[CapitalDelta]x", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]]}], "+", 
     RowBox[{"16", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "-", 
     RowBox[{"30", " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"16", " ", 
      SubscriptBox["u", "1"]}], "-", 
     SubscriptBox["u", "2"]}], 
    RowBox[{"12", " ", 
     SuperscriptBox["\[CapitalDelta]x", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"11", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "-", 
     RowBox[{"20", " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"6", " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"4", " ", 
      SubscriptBox["u", "2"]}], "-", 
     SubscriptBox["u", "3"]}], 
    RowBox[{"12", " ", 
     SuperscriptBox["\[CapitalDelta]x", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"35", " ", 
      SubscriptBox["u", "0"]}], "-", 
     RowBox[{"104", " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"114", " ", 
      SubscriptBox["u", "2"]}], "-", 
     RowBox[{"56", " ", 
      SubscriptBox["u", "3"]}], "+", 
     RowBox[{"11", " ", 
      SubscriptBox["u", "4"]}]}], 
    RowBox[{"12", " ", 
     SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.5726102083637886`*^9, 3.5726102364393945`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["11", 
       RowBox[{"12", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"-", 
       FractionBox["14", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
      FractionBox["19", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"-", 
       FractionBox["26", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
      FractionBox["35", 
       RowBox[{"12", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"12", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
      FractionBox["1", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"-", 
       FractionBox["5", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
      FractionBox["11", 
       RowBox[{"12", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"12", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
      FractionBox["4", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"-", 
       FractionBox["5", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
      FractionBox["4", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"12", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], "0", "0"},
     {"0", "0", "0", 
      FractionBox["11", 
       RowBox[{"12", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"-", 
       FractionBox["5", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      FractionBox["1", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"12", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], "0"},
     {"0", "0", "0", "0", 
      FractionBox["35", 
       RowBox[{"12", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"-", 
       FractionBox["26", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
      FractionBox["19", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"-", 
       FractionBox["14", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
      FractionBox["11", 
       RowBox[{"12", " ", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5726102083637886`*^9, 3.5726102364423943`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "=", 
  RowBox[{"LinearSolveWeights", "[", 
   RowBox[{"r", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{"w", "[", 
   RowBox[{"r", ",", "d"}], "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["3", "1540"]}], ",", 
   RowBox[{"-", 
    FractionBox["226", "1155"]}], ",", 
   FractionBox["293", "210"], ",", 
   RowBox[{"-", 
    FractionBox["226", "1155"]}], ",", 
   RowBox[{"-", 
    FractionBox["3", "1540"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5726102207874994`*^9, 3.5726102396065755`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.5726102207874994`*^9, 3.5726102396075754`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Smoothness indicators", "Subsection",
 CellChangeTimes->{3.583042848458372*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StencilSmoothness", "[", 
      RowBox[{"r", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "r"}], "}"}]}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{"279134", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "4"}], "2"]}], "+", 
         RowBox[{"5951369", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "3"}], "2"]}], "+", 
         RowBox[{"18768339", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "2"}], "2"]}], "-", 
         RowBox[{"30442116", " ", 
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", 
          SubscriptBox["u", 
           RowBox[{"-", "1"}]]}], "+", 
         RowBox[{"12627689", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "1"}], "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "3"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "21022356"}], " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "+", 
            RowBox[{"16810942", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"5121853", " ", 
             SubscriptBox["u", "0"]}]}], ")"}]}], "+", 
         RowBox[{"9424677", " ", 
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", 
          SubscriptBox["u", "0"]}], "-", 
         RowBox[{"8055511", " ", 
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["u", "0"]}], "+", 
         RowBox[{"1337954", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "4"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2569471"}], " ", 
             SubscriptBox["u", 
              RowBox[{"-", "3"}]]}], "+", 
            RowBox[{"4503117", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "-", 
            RowBox[{"3568693", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "+", 
            RowBox[{"1076779", " ", 
             SubscriptBox["u", "0"]}]}], ")"}]}]}], "60480"]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"82364", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "3"}], "2"]}], "+", 
         RowBox[{"1650569", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "2"}], "2"]}], "+", 
         RowBox[{"4854159", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "1"}], "2"]}], "-", 
         RowBox[{"7357656", " ", 
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["u", "0"]}], "+", 
         RowBox[{"2932409", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "5550816"}], " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "+", 
            RowBox[{"4054702", " ", 
             SubscriptBox["u", "0"]}], "-", 
            RowBox[{"1079563", " ", 
             SubscriptBox["u", "1"]}]}], ")"}]}], "+", 
         RowBox[{"2013987", " ", 
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["u", "1"]}], "-", 
         RowBox[{"1714561", " ", 
          SubscriptBox["u", "0"], " ", 
          SubscriptBox["u", "1"]}], "+", 
         RowBox[{"279134", " ", 
          SubsuperscriptBox["u", "1", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "3"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "725461"}], " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "+", 
            RowBox[{"1186167", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"847303", " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"221869", " ", 
             SubscriptBox["u", "1"]}]}], ")"}]}]}], "60480"]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"82364", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "2"}], "2"]}], "+", 
         RowBox[{"1228889", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "1"}], "2"]}], "+", 
         RowBox[{"2695779", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "-", 
         RowBox[{"3495756", " ", 
          SubscriptBox["u", "0"], " ", 
          SubscriptBox["u", "1"]}], "+", 
         RowBox[{"1228889", " ", 
          SubsuperscriptBox["u", "1", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3495756"}], " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"2100862", " ", 
             SubscriptBox["u", "1"]}], "-", 
            RowBox[{"461113", " ", 
             SubscriptBox["u", "2"]}]}], ")"}]}], "+", 
         RowBox[{"799977", " ", 
          SubscriptBox["u", "0"], " ", 
          SubscriptBox["u", "2"]}], "-", 
         RowBox[{"601771", " ", 
          SubscriptBox["u", "1"], " ", 
          SubscriptBox["u", "2"]}], "+", 
         RowBox[{"82364", " ", 
          SubsuperscriptBox["u", "2", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "601771"}], " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "+", 
            RowBox[{"799977", " ", 
             SubscriptBox["u", "0"]}], "-", 
            RowBox[{"461113", " ", 
             SubscriptBox["u", "1"]}], "+", 
            RowBox[{"98179", " ", 
             SubscriptBox["u", "2"]}]}], ")"}]}]}], "60480"]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"279134", " ", 
          SubsuperscriptBox["u", 
           RowBox[{"-", "1"}], "2"]}], "+", 
         RowBox[{"2932409", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "+", 
         RowBox[{"4854159", " ", 
          SubsuperscriptBox["u", "1", "2"]}], "-", 
         RowBox[{"5550816", " ", 
          SubscriptBox["u", "1"], " ", 
          SubscriptBox["u", "2"]}], "+", 
         RowBox[{"1650569", " ", 
          SubsuperscriptBox["u", "2", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", "0"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "7357656"}], " ", 
             SubscriptBox["u", "1"]}], "+", 
            RowBox[{"4054702", " ", 
             SubscriptBox["u", "2"]}], "-", 
            RowBox[{"847303", " ", 
             SubscriptBox["u", "3"]}]}], ")"}]}], "+", 
         RowBox[{"1186167", " ", 
          SubscriptBox["u", "1"], " ", 
          SubscriptBox["u", "3"]}], "-", 
         RowBox[{"725461", " ", 
          SubscriptBox["u", "2"], " ", 
          SubscriptBox["u", "3"]}], "+", 
         RowBox[{"82364", " ", 
          SubsuperscriptBox["u", "3", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1714561"}], " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"2013987", " ", 
             SubscriptBox["u", "1"]}], "-", 
            RowBox[{"1079563", " ", 
             SubscriptBox["u", "2"]}], "+", 
            RowBox[{"221869", " ", 
             SubscriptBox["u", "3"]}]}], ")"}]}]}], "60480"]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"1337954", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "+", 
         RowBox[{"12627689", " ", 
          SubsuperscriptBox["u", "1", "2"]}], "+", 
         RowBox[{"18768339", " ", 
          SubsuperscriptBox["u", "2", "2"]}], "-", 
         RowBox[{"21022356", " ", 
          SubscriptBox["u", "2"], " ", 
          SubscriptBox["u", "3"]}], "+", 
         RowBox[{"5951369", " ", 
          SubsuperscriptBox["u", "3", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", "1"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "30442116"}], " ", 
             SubscriptBox["u", "2"]}], "+", 
            RowBox[{"16810942", " ", 
             SubscriptBox["u", "3"]}], "-", 
            RowBox[{"3568693", " ", 
             SubscriptBox["u", "4"]}]}], ")"}]}], "+", 
         RowBox[{"4503117", " ", 
          SubscriptBox["u", "2"], " ", 
          SubscriptBox["u", "4"]}], "-", 
         RowBox[{"2569471", " ", 
          SubscriptBox["u", "3"], " ", 
          SubscriptBox["u", "4"]}], "+", 
         RowBox[{"279134", " ", 
          SubsuperscriptBox["u", "4", "2"]}], "+", 
         RowBox[{
          SubscriptBox["u", "0"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "8055511"}], " ", 
             SubscriptBox["u", "1"]}], "+", 
            RowBox[{"9424677", " ", 
             SubscriptBox["u", "2"]}], "-", 
            RowBox[{"5121853", " ", 
             SubscriptBox["u", "3"]}], "+", 
            RowBox[{"1076779", " ", 
             SubscriptBox["u", "4"]}]}], ")"}]}]}], "60480"]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5726105425759044`*^9, 3.572610543457955*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     SubscriptBox["IS", 
      RowBox[{"j", "-", "1"}]], "==", 
     RowBox[{"StencilSmoothness", "[", 
      RowBox[{"r", ",", "j"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "r"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "0"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "60480"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"279134", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "4"}], "2"]}], "-", 
     RowBox[{"2569471", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "4"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]]}], "+", 
     RowBox[{"5951369", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "3"}], "2"]}], "+", 
     RowBox[{"4503117", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "4"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]]}], "-", 
     RowBox[{"21022356", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]]}], "+", 
     RowBox[{"18768339", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "2"}], "2"]}], "-", 
     RowBox[{"3568693", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "4"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"16810942", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "-", 
     RowBox[{"30442116", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"12627689", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "1"}], "2"]}], "+", 
     RowBox[{"1076779", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "4"}]], " ", 
      SubscriptBox["u", "0"]}], "-", 
     RowBox[{"5121853", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"9424677", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", "0"]}], "-", 
     RowBox[{"8055511", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"1337954", " ", 
      SubsuperscriptBox["u", "0", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.5726105602339144`*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "1"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "60480"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"82364", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "3"}], "2"]}], "-", 
     RowBox[{"725461", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]]}], "+", 
     RowBox[{"1650569", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "2"}], "2"]}], "+", 
     RowBox[{"1186167", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "-", 
     RowBox[{"5550816", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"4854159", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "1"}], "2"]}], "-", 
     RowBox[{"847303", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"4054702", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", "0"]}], "-", 
     RowBox[{"7357656", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"2932409", " ", 
      SubsuperscriptBox["u", "0", "2"]}], "+", 
     RowBox[{"221869", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "3"}]], " ", 
      SubscriptBox["u", "1"]}], "-", 
     RowBox[{"1079563", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"2013987", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "1"]}], "-", 
     RowBox[{"1714561", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"279134", " ", 
      SubsuperscriptBox["u", "1", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.5726105603719225`*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "2"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "60480"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"82364", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "2"}], "2"]}], "-", 
     RowBox[{"601771", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]]}], "+", 
     RowBox[{"1228889", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "1"}], "2"]}], "+", 
     RowBox[{"799977", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", "0"]}], "-", 
     RowBox[{"3495756", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"2695779", " ", 
      SubsuperscriptBox["u", "0", "2"]}], "-", 
     RowBox[{"461113", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"2100862", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "1"]}], "-", 
     RowBox[{"3495756", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"1228889", " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{"98179", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "2"}]], " ", 
      SubscriptBox["u", "2"]}], "-", 
     RowBox[{"461113", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"799977", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "2"]}], "-", 
     RowBox[{"601771", " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"82364", " ", 
      SubsuperscriptBox["u", "2", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.572610560493929*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "3"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "60480"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"279134", " ", 
      SubsuperscriptBox["u", 
       RowBox[{"-", "1"}], "2"]}], "-", 
     RowBox[{"1714561", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "0"]}], "+", 
     RowBox[{"2932409", " ", 
      SubsuperscriptBox["u", "0", "2"]}], "+", 
     RowBox[{"2013987", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "1"]}], "-", 
     RowBox[{"7357656", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"4854159", " ", 
      SubsuperscriptBox["u", "1", "2"]}], "-", 
     RowBox[{"1079563", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"4054702", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "2"]}], "-", 
     RowBox[{"5550816", " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"1650569", " ", 
      SubsuperscriptBox["u", "2", "2"]}], "+", 
     RowBox[{"221869", " ", 
      SubscriptBox["u", 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["u", "3"]}], "-", 
     RowBox[{"847303", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "3"]}], "+", 
     RowBox[{"1186167", " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "3"]}], "-", 
     RowBox[{"725461", " ", 
      SubscriptBox["u", "2"], " ", 
      SubscriptBox["u", "3"]}], "+", 
     RowBox[{"82364", " ", 
      SubsuperscriptBox["u", "3", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.5726105606209364`*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "4"], "\[Equal]", 
  RowBox[{
   FractionBox["1", "60480"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"1337954", " ", 
      SubsuperscriptBox["u", "0", "2"]}], "-", 
     RowBox[{"8055511", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "1"]}], "+", 
     RowBox[{"12627689", " ", 
      SubsuperscriptBox["u", "1", "2"]}], "+", 
     RowBox[{"9424677", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "2"]}], "-", 
     RowBox[{"30442116", " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "2"]}], "+", 
     RowBox[{"18768339", " ", 
      SubsuperscriptBox["u", "2", "2"]}], "-", 
     RowBox[{"5121853", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "3"]}], "+", 
     RowBox[{"16810942", " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "3"]}], "-", 
     RowBox[{"21022356", " ", 
      SubscriptBox["u", "2"], " ", 
      SubscriptBox["u", "3"]}], "+", 
     RowBox[{"5951369", " ", 
      SubsuperscriptBox["u", "3", "2"]}], "+", 
     RowBox[{"1076779", " ", 
      SubscriptBox["u", "0"], " ", 
      SubscriptBox["u", "4"]}], "-", 
     RowBox[{"3568693", " ", 
      SubscriptBox["u", "1"], " ", 
      SubscriptBox["u", "4"]}], "+", 
     RowBox[{"4503117", " ", 
      SubscriptBox["u", "2"], " ", 
      SubscriptBox["u", "4"]}], "-", 
     RowBox[{"2569471", " ", 
      SubscriptBox["u", "3"], " ", 
      SubscriptBox["u", "4"]}], "+", 
     RowBox[{"279134", " ", 
      SubsuperscriptBox["u", "4", "2"]}]}], ")"}]}]}]], "Print",
 CellChangeTimes->{3.572610560750944*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"SmoothnessFactor", "[", 
     RowBox[{"r", ",", 
      RowBox[{"StencilSmoothness", "[", 
       RowBox[{"r", ",", "j"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "r"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"12627689", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"8055511", " ", 
             SubscriptBox["u", "0"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "3"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"5951369", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "3"}]]}], "-", 
            RowBox[{"21022356", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "+", 
            RowBox[{"16810942", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"5121853", " ", 
             SubscriptBox["u", "0"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{"668977", " ", 
          SubsuperscriptBox["u", "0", "2"]}], "30240"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "4"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"279134", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "4"}]]}], "-", 
            RowBox[{"2569471", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "3"}]]}], "+", 
            RowBox[{"4503117", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "-", 
            RowBox[{"3568693", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "+", 
            RowBox[{"1076779", " ", 
             SubscriptBox["u", "0"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6256113", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "-", 
            RowBox[{"10147372", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "+", 
            RowBox[{"3141559", " ", 
             SubscriptBox["u", "0"]}]}], ")"}]}], "20160"]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["u", "0"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2932409", " ", 
             SubscriptBox["u", "0"]}], "-", 
            RowBox[{"1714561", " ", 
             SubscriptBox["u", "1"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1650569", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "-", 
            RowBox[{"5550816", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "+", 
            RowBox[{"4054702", " ", 
             SubscriptBox["u", "0"]}], "-", 
            RowBox[{"1079563", " ", 
             SubscriptBox["u", "1"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{"139567", " ", 
          SubsuperscriptBox["u", "1", "2"]}], "30240"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "3"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"82364", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "3"}]]}], "-", 
            RowBox[{"725461", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "+", 
            RowBox[{"1186167", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"847303", " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"221869", " ", 
             SubscriptBox["u", "1"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1618053", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"2452552", " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"671329", " ", 
             SubscriptBox["u", "1"]}]}], ")"}]}], "20160"]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["u", "1"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1228889", " ", 
             SubscriptBox["u", "1"]}], "-", 
            RowBox[{"601771", " ", 
             SubscriptBox["u", "2"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1228889", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"3495756", " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"2100862", " ", 
             SubscriptBox["u", "1"]}], "-", 
            RowBox[{"461113", " ", 
             SubscriptBox["u", "2"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{"20591", " ", 
          SubsuperscriptBox["u", "2", "2"]}], "15120"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"82364", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "2"}]]}], "-", 
            RowBox[{"601771", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "+", 
            RowBox[{"799977", " ", 
             SubscriptBox["u", "0"]}], "-", 
            RowBox[{"461113", " ", 
             SubscriptBox["u", "1"]}], "+", 
            RowBox[{"98179", " ", 
             SubscriptBox["u", "2"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", "0"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"898593", " ", 
             SubscriptBox["u", "0"]}], "-", 
            RowBox[{"1165252", " ", 
             SubscriptBox["u", "1"]}], "+", 
            RowBox[{"266659", " ", 
             SubscriptBox["u", "2"]}]}], ")"}]}], "20160"]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["u", "0"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2932409", " ", 
             SubscriptBox["u", "0"]}], "-", 
            RowBox[{"7357656", " ", 
             SubscriptBox["u", "1"]}], "+", 
            RowBox[{"4054702", " ", 
             SubscriptBox["u", "2"]}], "-", 
            RowBox[{"847303", " ", 
             SubscriptBox["u", "3"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1650569", " ", 
             SubscriptBox["u", "2"]}], "-", 
            RowBox[{"725461", " ", 
             SubscriptBox["u", "3"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{"20591", " ", 
          SubsuperscriptBox["u", "3", "2"]}], "15120"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", 
           RowBox[{"-", "1"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"279134", " ", 
             SubscriptBox["u", 
              RowBox[{"-", "1"}]]}], "-", 
            RowBox[{"1714561", " ", 
             SubscriptBox["u", "0"]}], "+", 
            RowBox[{"2013987", " ", 
             SubscriptBox["u", "1"]}], "-", 
            RowBox[{"1079563", " ", 
             SubscriptBox["u", "2"]}], "+", 
            RowBox[{"221869", " ", 
             SubscriptBox["u", "3"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", "1"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1618053", " ", 
             SubscriptBox["u", "1"]}], "-", 
            RowBox[{"1850272", " ", 
             SubscriptBox["u", "2"]}], "+", 
            RowBox[{"395389", " ", 
             SubscriptBox["u", "3"]}]}], ")"}]}], "20160"]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["u", "1"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"12627689", " ", 
             SubscriptBox["u", "1"]}], "-", 
            RowBox[{"30442116", " ", 
             SubscriptBox["u", "2"]}], "+", 
            RowBox[{"16810942", " ", 
             SubscriptBox["u", "3"]}], "-", 
            RowBox[{"3568693", " ", 
             SubscriptBox["u", "4"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"5951369", " ", 
             SubscriptBox["u", "3"]}], "-", 
            RowBox[{"2569471", " ", 
             SubscriptBox["u", "4"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{"139567", " ", 
          SubsuperscriptBox["u", "4", "2"]}], "30240"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", "0"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1337954", " ", 
             SubscriptBox["u", "0"]}], "-", 
            RowBox[{"8055511", " ", 
             SubscriptBox["u", "1"]}], "+", 
            RowBox[{"9424677", " ", 
             SubscriptBox["u", "2"]}], "-", 
            RowBox[{"5121853", " ", 
             SubscriptBox["u", "3"]}], "+", 
            RowBox[{"1076779", " ", 
             SubscriptBox["u", "4"]}]}], ")"}]}], "60480"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["u", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6256113", " ", 
             SubscriptBox["u", "2"]}], "-", 
            RowBox[{"7007452", " ", 
             SubscriptBox["u", "3"]}], "+", 
            RowBox[{"1501039", " ", 
             SubscriptBox["u", "4"]}]}], ")"}]}], "20160"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.572610572184598*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     SubscriptBox["IS", 
      RowBox[{"j", "-", "1"}]], "==", 
     RowBox[{"SmoothnessFactor", "[", 
      RowBox[{"r", ",", 
       RowBox[{"StencilSmoothness", "[", 
        RowBox[{"r", ",", "j"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "r"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "0"], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "1"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"12627689", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "-", 
       RowBox[{"8055511", " ", 
        SubscriptBox["u", "0"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "3"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"5951369", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "3"}]]}], "-", 
       RowBox[{"21022356", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]]}], "+", 
       RowBox[{"16810942", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "-", 
       RowBox[{"5121853", " ", 
        SubscriptBox["u", "0"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{"668977", " ", 
     SubsuperscriptBox["u", "0", "2"]}], "30240"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "4"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"279134", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "4"}]]}], "-", 
       RowBox[{"2569471", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "3"}]]}], "+", 
       RowBox[{"4503117", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]]}], "-", 
       RowBox[{"3568693", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "+", 
       RowBox[{"1076779", " ", 
        SubscriptBox["u", "0"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "2"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6256113", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]]}], "-", 
       RowBox[{"10147372", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "+", 
       RowBox[{"3141559", " ", 
        SubscriptBox["u", "0"]}]}], ")"}]}], "20160"]}]}]], "Print",
 CellChangeTimes->{3.572610582153168*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "1"], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox["u", "0"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2932409", " ", 
        SubscriptBox["u", "0"]}], "-", 
       RowBox[{"1714561", " ", 
        SubscriptBox["u", "1"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "2"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1650569", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]]}], "-", 
       RowBox[{"5550816", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "+", 
       RowBox[{"4054702", " ", 
        SubscriptBox["u", "0"]}], "-", 
       RowBox[{"1079563", " ", 
        SubscriptBox["u", "1"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{"139567", " ", 
     SubsuperscriptBox["u", "1", "2"]}], "30240"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "3"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"82364", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "3"}]]}], "-", 
       RowBox[{"725461", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]]}], "+", 
       RowBox[{"1186167", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "-", 
       RowBox[{"847303", " ", 
        SubscriptBox["u", "0"]}], "+", 
       RowBox[{"221869", " ", 
        SubscriptBox["u", "1"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "1"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1618053", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "-", 
       RowBox[{"2452552", " ", 
        SubscriptBox["u", "0"]}], "+", 
       RowBox[{"671329", " ", 
        SubscriptBox["u", "1"]}]}], ")"}]}], "20160"]}]}]], "Print",
 CellChangeTimes->{3.572610582294176*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "2"], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox["u", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1228889", " ", 
        SubscriptBox["u", "1"]}], "-", 
       RowBox[{"601771", " ", 
        SubscriptBox["u", "2"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "1"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1228889", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "-", 
       RowBox[{"3495756", " ", 
        SubscriptBox["u", "0"]}], "+", 
       RowBox[{"2100862", " ", 
        SubscriptBox["u", "1"]}], "-", 
       RowBox[{"461113", " ", 
        SubscriptBox["u", "2"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{"20591", " ", 
     SubsuperscriptBox["u", "2", "2"]}], "15120"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "2"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"82364", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "2"}]]}], "-", 
       RowBox[{"601771", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "+", 
       RowBox[{"799977", " ", 
        SubscriptBox["u", "0"]}], "-", 
       RowBox[{"461113", " ", 
        SubscriptBox["u", "1"]}], "+", 
       RowBox[{"98179", " ", 
        SubscriptBox["u", "2"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", "0"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"898593", " ", 
        SubscriptBox["u", "0"]}], "-", 
       RowBox[{"1165252", " ", 
        SubscriptBox["u", "1"]}], "+", 
       RowBox[{"266659", " ", 
        SubscriptBox["u", "2"]}]}], ")"}]}], "20160"]}]}]], "Print",
 CellChangeTimes->{3.5726105824221835`*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "3"], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox["u", "0"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2932409", " ", 
        SubscriptBox["u", "0"]}], "-", 
       RowBox[{"7357656", " ", 
        SubscriptBox["u", "1"]}], "+", 
       RowBox[{"4054702", " ", 
        SubscriptBox["u", "2"]}], "-", 
       RowBox[{"847303", " ", 
        SubscriptBox["u", "3"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1650569", " ", 
        SubscriptBox["u", "2"]}], "-", 
       RowBox[{"725461", " ", 
        SubscriptBox["u", "3"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{"20591", " ", 
     SubsuperscriptBox["u", "3", "2"]}], "15120"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"-", "1"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"279134", " ", 
        SubscriptBox["u", 
         RowBox[{"-", "1"}]]}], "-", 
       RowBox[{"1714561", " ", 
        SubscriptBox["u", "0"]}], "+", 
       RowBox[{"2013987", " ", 
        SubscriptBox["u", "1"]}], "-", 
       RowBox[{"1079563", " ", 
        SubscriptBox["u", "2"]}], "+", 
       RowBox[{"221869", " ", 
        SubscriptBox["u", "3"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1618053", " ", 
        SubscriptBox["u", "1"]}], "-", 
       RowBox[{"1850272", " ", 
        SubscriptBox["u", "2"]}], "+", 
       RowBox[{"395389", " ", 
        SubscriptBox["u", "3"]}]}], ")"}]}], "20160"]}]}]], "Print",
 CellChangeTimes->{3.572610582552191*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["IS", "4"], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox["u", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"12627689", " ", 
        SubscriptBox["u", "1"]}], "-", 
       RowBox[{"30442116", " ", 
        SubscriptBox["u", "2"]}], "+", 
       RowBox[{"16810942", " ", 
        SubscriptBox["u", "3"]}], "-", 
       RowBox[{"3568693", " ", 
        SubscriptBox["u", "4"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"5951369", " ", 
        SubscriptBox["u", "3"]}], "-", 
       RowBox[{"2569471", " ", 
        SubscriptBox["u", "4"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{"139567", " ", 
     SubsuperscriptBox["u", "4", "2"]}], "30240"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", "0"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1337954", " ", 
        SubscriptBox["u", "0"]}], "-", 
       RowBox[{"8055511", " ", 
        SubscriptBox["u", "1"]}], "+", 
       RowBox[{"9424677", " ", 
        SubscriptBox["u", "2"]}], "-", 
       RowBox[{"5121853", " ", 
        SubscriptBox["u", "3"]}], "+", 
       RowBox[{"1076779", " ", 
        SubscriptBox["u", "4"]}]}], ")"}]}], "60480"], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["u", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6256113", " ", 
        SubscriptBox["u", "2"]}], "-", 
       RowBox[{"7007452", " ", 
        SubscriptBox["u", "3"]}], "+", 
       RowBox[{"1501039", " ", 
        SubscriptBox["u", "4"]}]}], ")"}]}], "20160"]}]}]], "Print",
 CellChangeTimes->{3.5726105826821985`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cheers", "."}], " ", ";"}], " ", ")"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Manuel", " ", "Diaz"}], ",", " ", "2013"}]}], "Input",
 CellChangeTimes->{{3.583213447223926*^9, 3.583213447225926*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Final observations", "Section"]], "Section",
 CellChangeTimes->{{3.583213458292559*^9, 3.583213469459198*^9}}],

Cell["\<\
Here we can continue modifying this notebook to compute higher order WENO \
approximations.

Cheers. ; )

Manuel Diaz, 2013\
\>", "Text",
 CellChangeTimes->{{3.5832131128488007`*^9, 3.583213175347376*^9}, {
   3.5832132500356474`*^9, 3.5832132710918517`*^9}, {3.5832133300432234`*^9, 
   3.58321333959577*^9}, {3.5832135763793135`*^9, 3.583213576739334*^9}, 
   3.5949845052036705`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1288, 673},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 332, 4, 101, "Title"],
Cell[914, 28, 238, 5, 91, "Subtitle"],
Cell[1155, 35, 304, 8, 31, "Input"],
Cell[CellGroupData[{
Cell[1484, 47, 93, 1, 49, "Subsection"],
Cell[1580, 50, 624, 11, 68, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2241, 66, 194, 5, 127, "Section"],
Cell[2438, 73, 610, 11, 54, "Text"],
Cell[CellGroupData[{
Cell[3073, 88, 112, 1, 49, "Subsection"],
Cell[3188, 91, 1289, 38, 72, "Input"],
Cell[4480, 131, 722, 18, 52, "Input"],
Cell[CellGroupData[{
Cell[5227, 153, 135, 1, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[5387, 158, 1244, 30, 92, "Input"],
Cell[6634, 190, 1013, 29, 70, "Output"],
Cell[7650, 221, 1000, 28, 70, "Output"],
Cell[8653, 251, 744, 21, 70, "Output"],
Cell[9400, 274, 1922, 58, 70, "Output"]
}, Open  ]],
Cell[11337, 335, 349, 8, 31, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[11735, 349, 131, 2, 41, "Subsection"],
Cell[11869, 353, 289, 5, 30, "Text"],
Cell[12161, 360, 1310, 39, 60, "Input"],
Cell[13474, 401, 1190, 31, 54, "Input"],
Cell[14667, 434, 374, 9, 31, "Input"],
Cell[CellGroupData[{
Cell[15066, 447, 351, 7, 72, "Input"],
Cell[15420, 456, 847, 27, 70, "Output"],
Cell[16270, 485, 777, 24, 70, "Output"],
Cell[17050, 511, 715, 21, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[17814, 538, 253, 3, 41, "Subsection"],
Cell[18070, 543, 475, 11, 52, "Input"],
Cell[18548, 556, 444, 12, 31, "Input"],
Cell[18995, 570, 421, 10, 31, "Input"],
Cell[19419, 582, 616, 16, 31, "Input"],
Cell[20038, 600, 425, 10, 31, "Input"],
Cell[20466, 612, 601, 17, 31, "Input"],
Cell[21070, 631, 501, 11, 52, "Input"],
Cell[21574, 644, 1207, 32, 92, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22818, 681, 197, 4, 49, "Subsection"],
Cell[23018, 687, 816, 23, 52, "Input"],
Cell[23837, 712, 309, 6, 31, "Input"],
Cell[24149, 720, 533, 14, 31, "Input"],
Cell[24685, 736, 545, 11, 52, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[25279, 753, 222, 6, 97, "Section"],
Cell[25504, 761, 196, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[25725, 769, 150, 2, 49, "Subsection"],
Cell[25878, 773, 813, 17, 92, "Input"],
Cell[26694, 792, 699, 19, 92, "Input"],
Cell[27396, 813, 364, 10, 45, "Input"],
Cell[27763, 825, 530, 16, 44, "Input"],
Cell[28296, 843, 439, 12, 46, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[28772, 860, 184, 2, 41, "Subsection"],
Cell[28959, 864, 482, 12, 31, "Input"],
Cell[29444, 878, 1096, 33, 48, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[30589, 917, 124, 4, 97, "Section"],
Cell[30716, 923, 140, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[30881, 930, 138, 1, 49, "Subsection"],
Cell[31022, 933, 665, 15, 52, "Input"],
Cell[CellGroupData[{
Cell[31712, 952, 571, 17, 92, "Input"],
Cell[32286, 971, 459, 13, 47, "Output"],
Cell[32748, 986, 928, 30, 47, "Output"],
Cell[33679, 1018, 3020, 91, 48, "Output"]
}, Open  ]],
Cell[36714, 1112, 369, 8, 31, "Input"],
Cell[CellGroupData[{
Cell[37108, 1124, 465, 13, 52, "Input"],
Cell[37576, 1139, 1140, 35, 131, "Output"],
Cell[38719, 1176, 1384, 41, 142, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40140, 1222, 349, 9, 52, "Input"],
Cell[40492, 1233, 293, 7, 46, "Output"],
Cell[40788, 1242, 172, 2, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41009, 1250, 287, 4, 49, "Subsection"],
Cell[41299, 1256, 142, 3, 31, "Input"],
Cell[41444, 1261, 595, 14, 52, "Input"],
Cell[CellGroupData[{
Cell[42064, 1279, 332, 10, 52, "Input"],
Cell[42399, 1291, 556, 17, 70, "Output"],
Cell[42958, 1310, 886, 28, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43881, 1343, 379, 10, 52, "Input"],
Cell[44263, 1355, 326, 9, 70, "Output"],
Cell[44592, 1366, 163, 2, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[44804, 1374, 235, 3, 41, "Subsection"],
Cell[CellGroupData[{
Cell[45064, 1381, 278, 9, 31, "Input"],
Cell[45345, 1392, 3211, 95, 87, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48593, 1492, 432, 12, 31, "Input"],
Cell[CellGroupData[{
Cell[49050, 1508, 897, 29, 40, "Print"],
Cell[49950, 1539, 828, 26, 40, "Print"],
Cell[50781, 1567, 759, 23, 40, "Print"]
}, Open  ]]
}, Open  ]],
Cell[51567, 1594, 952, 23, 52, "Input"],
Cell[CellGroupData[{
Cell[52544, 1621, 381, 10, 31, "Input"],
Cell[52928, 1633, 3182, 98, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56147, 1736, 457, 13, 31, "Input"],
Cell[CellGroupData[{
Cell[56629, 1753, 923, 32, 43, "Print"],
Cell[57555, 1787, 793, 27, 43, "Print"],
Cell[58351, 1816, 809, 27, 43, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59233, 1851, 124, 4, 127, "Section"],
Cell[59360, 1857, 186, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[59571, 1865, 132, 2, 49, "Subsection"],
Cell[59706, 1869, 133, 3, 31, "Input"],
Cell[59842, 1874, 665, 15, 52, "Input"],
Cell[CellGroupData[{
Cell[60532, 1893, 634, 18, 72, "Input"],
Cell[61169, 1913, 569, 19, 47, "Output"],
Cell[61741, 1934, 1602, 55, 47, "Output"],
Cell[63346, 1991, 1983, 57, 116, "Output"]
}, Open  ]],
Cell[65344, 2051, 204, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[65573, 2060, 348, 9, 52, "Input"],
Cell[65924, 2071, 253, 7, 46, "Output"],
Cell[66180, 2080, 94, 1, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66323, 2087, 133, 2, 49, "Subsection"],
Cell[66459, 2091, 1145, 24, 92, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[67641, 2120, 85, 1, 41, "Subsection"],
Cell[CellGroupData[{
Cell[67751, 2125, 278, 9, 31, "Input"],
Cell[68032, 2136, 5765, 167, 136, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73834, 2308, 313, 10, 31, "Input"],
Cell[CellGroupData[{
Cell[74172, 2322, 1387, 45, 40, "Print"],
Cell[75562, 2369, 1290, 41, 40, "Print"],
Cell[76855, 2412, 1198, 37, 40, "Print"],
Cell[78056, 2451, 1111, 33, 40, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79216, 2490, 313, 9, 31, "Input"],
Cell[79532, 2501, 6232, 186, 136, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85801, 2692, 390, 12, 31, "Input"],
Cell[CellGroupData[{
Cell[86216, 2708, 1419, 49, 43, "Print"],
Cell[87638, 2759, 1324, 45, 43, "Print"],
Cell[88965, 2806, 1253, 42, 43, "Print"],
Cell[90221, 2850, 1209, 40, 43, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[91503, 2898, 177, 5, 97, "Section"],
Cell[91683, 2905, 135, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[91843, 2912, 78, 1, 49, "Subsection"],
Cell[91924, 2915, 140, 3, 31, "Input"],
Cell[92067, 2920, 691, 16, 72, "Input"],
Cell[CellGroupData[{
Cell[92783, 2940, 564, 17, 72, "Input"],
Cell[93350, 2959, 717, 24, 47, "Output"],
Cell[94070, 2985, 2198, 75, 84, "Output"],
Cell[96271, 3062, 2693, 77, 142, "Output"]
}, Open  ]],
Cell[98979, 3142, 204, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[99208, 3151, 283, 8, 52, "Input"],
Cell[99494, 3161, 263, 8, 46, "Output"],
Cell[99760, 3171, 72, 1, 31, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[99881, 3178, 131, 2, 41, "Subsection"],
Cell[100015, 3182, 133, 3, 31, "Input"],
Cell[100151, 3187, 661, 15, 72, "Input"],
Cell[CellGroupData[{
Cell[100837, 3206, 564, 17, 72, "Input"],
Cell[101404, 3225, 831, 28, 48, "Output"],
Cell[102238, 3255, 2385, 81, 86, "Output"],
Cell[104626, 3338, 3628, 107, 147, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108291, 3450, 283, 8, 52, "Input"],
Cell[108577, 3460, 383, 12, 46, "Output"],
Cell[108963, 3474, 98, 1, 31, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[109110, 3481, 85, 1, 41, "Subsection"],
Cell[CellGroupData[{
Cell[109220, 3486, 278, 9, 31, "Input"],
Cell[109501, 3497, 9984, 280, 167, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119522, 3782, 313, 10, 31, "Input"],
Cell[CellGroupData[{
Cell[119860, 3796, 2090, 67, 62, "Print"],
Cell[121953, 3865, 1965, 62, 62, "Print"],
Cell[123921, 3929, 1842, 57, 62, "Print"],
Cell[125766, 3988, 1735, 52, 62, "Print"],
Cell[127504, 4042, 1628, 47, 62, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129181, 4095, 313, 9, 31, "Input"],
Cell[129497, 4106, 10800, 313, 167, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140334, 4424, 390, 12, 31, "Input"],
Cell[CellGroupData[{
Cell[140749, 4440, 2050, 69, 79, "Print"],
Cell[142802, 4511, 1919, 64, 79, "Print"],
Cell[144724, 4577, 1818, 60, 79, "Print"],
Cell[146545, 4639, 1750, 57, 79, "Print"],
Cell[148298, 4698, 1714, 55, 79, "Print"]
}, Open  ]]
}, Open  ]],
Cell[150039, 4757, 257, 7, 68, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[150345, 4770, 134, 1, 56, "Section"],
Cell[150482, 4773, 396, 11, 106, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
