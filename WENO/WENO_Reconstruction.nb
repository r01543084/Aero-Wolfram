(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     45454,       1485]
NotebookOptionsPosition[     41620,       1354]
NotebookOutlinePosition[     41958,       1369]
CellTagsIndexPosition[     41915,       1366]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["WENO Reconstruction", "Title",
 CellChangeTimes->{{3.583208418129278*^9, 3.5832084289228954`*^9}, {
   3.5832133980991163`*^9, 3.583213409083744*^9}, {3.5949855937889347`*^9, 
   3.5949856166522417`*^9}, 3.59498679596264*^9}],

Cell["\<\
coded by Manuel Diaz, 2012.12.02\
\>", "Subtitle",
 CellChangeTimes->{{3.5832084306679955`*^9, 3.5832084442187705`*^9}, 
   3.5832133685094237`*^9, {3.5949848259160147`*^9, 3.594984826140027*^9}, {
   3.5949856197724204`*^9, 3.594985636779393*^9}, {3.59605483267524*^9, 
   3.596054832731173*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Quit", "[", "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Reset", " ", "Mathematica", " ", "Kernel"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.58321335165546*^9, 3.5832133628941026`*^9}}],

Cell[CellGroupData[{

Cell["Refs,", "Subsection",
 CellChangeTimes->{{3.583213320171659*^9, 3.5832133224917917`*^9}, {
  3.583213423363561*^9, 3.5832134234035635`*^9}}],

Cell["\<\
Based on 
1. C.-W. Shu, High order weighted essentially non-oscillatory schemes for \
convection dominated problems, SIAM Review, 51:82-126, 2009.\
\>", "Text",
 CellChangeTimes->{{3.583210214452022*^9, 3.583210218821272*^9}, {
  3.5832108275000863`*^9, 3.5832108406908407`*^9}, {3.583213288756862*^9, 
  3.583213307748948*^9}, {3.5949867194075317`*^9, 3.594986719727532*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The Reconstruction of Contributor Polynomials\
\>", "Section",
 CellChangeTimes->{{3.5960478391370487`*^9, 3.596047843704979*^9}, {
   3.596056589251276*^9, 3.5960566093791723`*^9}, 3.596058337091763*^9}],

Cell[TextData[{
 "Let us build a grid with nodes, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"i", " "}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", and cell averages, ",
 Cell[BoxData[
  SubscriptBox[
   OverscriptBox["u", "_"], "i"]],
  CellChangeTimes->{{3.596049075158217*^9, 3.596049101922065*^9}, 
    3.5960492154159737`*^9, 3.596049248342536*^9, 3.596049360377675*^9, 
    3.5960523692360907`*^9, 3.5960531818607264`*^9, 3.596054300560794*^9}],
 ":"
}], "Text",
 CellChangeTimes->{{3.596054668626384*^9, 3.596054717818861*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["cell", "averages"], "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "j"], ",", 
      SubscriptBox[
       OverscriptBox["u", "_"], "j"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.596048996681319*^9, 3.596049100613237*^9}, {
   3.59604919263822*^9, 3.596049211870274*^9}, {3.596049246710725*^9, 
   3.596049247741962*^9}, 3.596049358926642*^9, {3.5960523670393877`*^9, 
   3.596052367719041*^9}, {3.596053179503446*^9, 3.596053180999488*^9}, {
   3.5960542997591677`*^9, 3.59605429983258*^9}, 3.596054657033976*^9, {
   3.596054967161046*^9, 3.596054968799061*^9}, {3.596055185719901*^9, 
   3.596055196271934*^9}, {3.596055723864901*^9, 3.596055747927733*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"-", "5"}]], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], 
      RowBox[{"-", "5"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"-", "4"}]], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], 
      RowBox[{"-", "4"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"-", "3"}]], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], 
      RowBox[{"-", "3"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"-", "2"}]], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], 
      RowBox[{"-", "2"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"-", "1"}]], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], 
      RowBox[{"-", "1"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "0"], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], "0"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "1"], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "2"], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "3"], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "4"], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "5"], ",", 
     SubscriptBox[
      OverscriptBox["u", "_"], "5"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.596049075158217*^9, 3.596049101922065*^9}, 
   3.5960492154159737`*^9, 3.596049248342536*^9, 3.596049360377675*^9, 
   3.5960523692360907`*^9, 3.5960531818607264`*^9, 3.596054300560794*^9, 
   3.5960549696814127`*^9, 3.596055007364759*^9, 3.596055197364297*^9, 
   3.596055264711491*^9, {3.5960555050090218`*^9, 3.5960555188519573`*^9}, 
   3.596055754205563*^9, 3.5960558447836637`*^9, 3.596055910369624*^9, 
   3.596056198143651*^9, 3.596057434766033*^9, 3.5960580644021473`*^9}]
}, Open  ]],

Cell["\<\
Let us define a primite function U(x) as:\
\>", "Text",
 CellChangeTimes->{{3.596049266729487*^9, 3.5960492958254766`*^9}, {
  3.596049831321599*^9, 3.5960498317772427`*^9}, {3.596051742114347*^9, 
  3.5960517575381107`*^9}, {3.596053025906156*^9, 3.596053036634138*^9}, {
  3.596054730234633*^9, 3.596054742771104*^9}}],

Cell[TextData[{
 "U[x] = ",
 Cell[BoxData[
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "x"], 
   RowBox[{
    RowBox[{"u", "[", "\[Xi]", "]"}], 
    RowBox[{"\[DifferentialD]", "\[Xi]"}]}]}]]],
 " "
}], "Text",
 CellChangeTimes->{{3.596049893169551*^9, 3.596049970401289*^9}, {
  3.596050149785445*^9, 3.5960501505857077`*^9}}],

Cell["\<\
choose j=-5 as the lower reference or our domain for computing value with \
primitive function,\
\>", "Text",
 CellChangeTimes->{{3.596049973017364*^9, 3.596049996009252*^9}, {
  3.5960524506663427`*^9, 3.596052463018221*^9}, {3.596053188018565*^9, 
  3.596053188121793*^9}, {3.596054755122615*^9, 3.5960547813545094`*^9}, {
  3.596055788954937*^9, 3.5960558299709263`*^9}}],

Cell[TextData[{
 "U[x] = ",
 Cell[BoxData[
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"l", "=", "0"}], "i"], 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     SubscriptBox["x", 
      RowBox[{"i", "-", 
       RowBox[{"1", "/", "2"}]}]], 
     SubscriptBox["x", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}]]], 
    RowBox[{
     RowBox[{"u", "[", "\[Xi]", "]"}], 
     RowBox[{"\[DifferentialD]", "\[Xi]"}]}]}]}]]],
 " = ",
 Cell[BoxData[
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"l", "=", "0"}], "i"], 
   RowBox[{"\[CapitalDelta]x", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], "l"]}]}]],
  CellChangeTimes->{{3.59604939354469*^9, 3.596049400788136*^9}, {
   3.5960494439556303`*^9, 3.596049474700924*^9}, {3.596049528901301*^9, 
   3.596049607182159*^9}, {3.596049652334797*^9, 3.596049655286892*^9}}]
}], "Text",
 CellChangeTimes->{
  3.596050003226611*^9, {3.596050035641459*^9, 3.5960501023165894`*^9}, {
   3.5960501522572517`*^9, 3.5960501528971663`*^9}}],

Cell["\<\
Set in Matematica the numerical equivalent of our primite function:\
\>", "Text",
 CellChangeTimes->{{3.596054789906603*^9, 3.5960548070026693`*^9}, {
  3.596054859763206*^9, 3.596054863947432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptU]", "[", "i_", "]"}], ":=", " ", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"l", "=", 
     RowBox[{"-", "5"}]}], "i"], 
   RowBox[{"\[CapitalDelta]x", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], "l"], " ", 
    RowBox[{"(*", 
     RowBox[{"Integrates", " ", "up", " ", 
      RowBox[{"to", ":", " ", 
       RowBox[{"U", "[", 
        SubscriptBox["x", 
         RowBox[{"i", "+", 
          RowBox[{"1", "/", "2"}]}]], "]"}]}]}], " ", "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.59604939354469*^9, 3.596049400788136*^9}, {
  3.5960494439556303`*^9, 3.596049474700924*^9}, {3.596049528901301*^9, 
  3.596049607182159*^9}, {3.596049652334797*^9, 3.596049655286892*^9}, {
  3.59605247251926*^9, 3.596052473150956*^9}, {3.5960525473036547`*^9, 
  3.596052547407288*^9}, {3.596055785752195*^9, 3.596055785807734*^9}}],

Cell[TextData[{
 "Use this primitive function to compute values at the halft nodes, e.i.: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "(", 
    SubscriptBox["x", 
     RowBox[{"j", "+", 
      RowBox[{"1", "/", "2"}]}]]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "). "
}], "Text",
 CellChangeTimes->{{3.596053109588111*^9, 3.596053138085003*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}]], " ", "=", " ", 
     RowBox[{"\[ScriptU]", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"-", "3"}], ",", "0"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["V", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}]], " ", "=", " ", 
     RowBox[{"\[ScriptU]", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"-", "2"}], ",", "1"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["W", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}]], " ", "=", " ", 
     RowBox[{"\[ScriptU]", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}]], " ", "=", " ", 
     RowBox[{"\[ScriptU]", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.596049548495791*^9, 3.596049557644186*^9}, {
  3.596049626901855*^9, 3.596049690125576*^9}, {3.5960523796390123`*^9, 
  3.5960523926305447`*^9}, {3.596053619751562*^9, 3.596053641193153*^9}, {
  3.596053719016975*^9, 3.596053720520884*^9}, {3.596054120361651*^9, 
  3.596054120465322*^9}, {3.596054975433302*^9, 3.596054985624992*^9}, {
  3.596055204265757*^9, 3.596055215379125*^9}, {3.596055420808453*^9, 
  3.5960554375625477`*^9}, {3.596055867026718*^9, 3.596055868296274*^9}}],

Cell[TextData[{
 "Let us create an interpolation using these primitive values a the half \
nodes ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "(", 
    SubscriptBox["x", 
     RowBox[{"j", "+", 
      RowBox[{"1", "/", "2"}]}]]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ").\nFor example: Let\[CloseCurlyQuote]s create a polynomial P(x) of degree \
3 that interpolates half nodes ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"j", "+", 
     RowBox[{"1", "/", "2"}]}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", j = -3, -2, -1, 0."
}], "Text",
 CellChangeTimes->{{3.5960498348968697`*^9, 3.59604987220131*^9}, {
  3.596050184345871*^9, 3.5960502017077713`*^9}, {3.5960515288021517`*^9, 
  3.5960516144674883`*^9}, {3.596053849626288*^9, 3.596053858618307*^9}}],

Cell["\<\
set the data for interpolation:\
\>", "Text",
 CellChangeTimes->{{3.5960563159314747`*^9, 3.5960563210353518`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["data", "1"], " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i", " ", "\[CapitalDelta]x"}], ",", 
       SubscriptBox["U", 
        RowBox[{"i", "+", 
         RowBox[{"1", "/", "2"}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "3"}], ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["data", "2"], " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i", " ", "\[CapitalDelta]x"}], ",", 
       SubscriptBox["V", 
        RowBox[{"i", "+", 
         RowBox[{"1", "/", "2"}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "2"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["data", "3"], " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i", " ", "\[CapitalDelta]x"}], ",", 
       SubscriptBox["W", 
        RowBox[{"i", "+", 
         RowBox[{"1", "/", "2"}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["data", "4"], " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i", " ", "\[CapitalDelta]x"}], ",", 
       SubscriptBox["X", 
        RowBox[{"i", "+", 
         RowBox[{"1", "/", "2"}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.594987266248544*^9, 3.594987305471599*^9}, {
  3.5949873483836594`*^9, 3.5949873769656997`*^9}, {3.5949880028365993`*^9, 
  3.5949880031365995`*^9}, {3.596051460278574*^9, 3.59605149199802*^9}, {
  3.596052517246874*^9, 3.5960525201186943`*^9}, {3.5960543354558907`*^9, 
  3.596054369145582*^9}, {3.596054424481587*^9, 3.596054427680928*^9}, {
  3.596055030274373*^9, 3.596055040841812*^9}, {3.596055220196023*^9, 
  3.596055232969947*^9}, {3.596055442992622*^9, 3.5960554790907507`*^9}, {
  3.596055873250514*^9, 3.5960558742802477`*^9}, {3.596056119955412*^9, 
  3.596056128530662*^9}}],

Cell["\<\
Build interpolation Polynomials:\
\>", "Text",
 CellChangeTimes->{{3.596056326811367*^9, 3.596056344499406*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["P", "i"], "=", 
     RowBox[{"InterpolatingPolynomial", "[", 
      RowBox[{
       SubscriptBox["data", "i"], ",", "x"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.594987381515706*^9, 3.5949874240677657`*^9}, {
  3.5949875070138817`*^9, 3.5949875161238947`*^9}, {3.596051855783155*^9, 
  3.596051858715489*^9}, {3.596053900134418*^9, 3.59605390359203*^9}, {
  3.596054222342513*^9, 3.59605424402071*^9}, {3.596054380718418*^9, 
  3.59605439335203*^9}, {3.596055468055623*^9, 3.596055474920402*^9}, {
  3.596055879105262*^9, 3.596055879927402*^9}, {3.596056135305044*^9, 
  3.596056209222973*^9}, {3.596056290095171*^9, 3.596056296389361*^9}, {
  3.596056332824119*^9, 3.5960563348155947`*^9}}],

Cell[TextData[{
 "The interpolation at the reference point, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"i", "+", 
     RowBox[{"1", "/", "2"}]}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", is:"
}], "Text",
 CellChangeTimes->{{3.596056375747291*^9, 3.596056405595428*^9}, {
  3.5960573706278963`*^9, 3.596057374163249*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reconstructedP", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         SubscriptBox["P", "i"], ",", "x"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", "0"}]}], "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.5949875241749063`*^9, 3.5949875666059656`*^9}, {
  3.594987709037168*^9, 3.594987733238202*^9}, {3.5960518652137938`*^9, 
  3.596051865748376*^9}, {3.596052031422133*^9, 3.59605205077551*^9}, {
  3.596053911134264*^9, 3.596053914710753*^9}, {3.596054211614377*^9, 
  3.596054239341011*^9}, {3.596054401207005*^9, 3.596054402918199*^9}, {
  3.5960544330386887`*^9, 3.5960544523763437`*^9}, {3.596055484367667*^9, 
  3.5960554889684668`*^9}, {3.5960558843130703`*^9, 3.596055885143573*^9}, {
  3.596055933208459*^9, 3.596055963782877*^9}, {3.596056008239954*^9, 
  3.596056075785552*^9}, {3.5960562200804567`*^9, 3.5960562532718687`*^9}, {
  3.5960564732009563`*^9, 3.5960564823206453`*^9}, {3.596057448105009*^9, 
  3.596057448154066*^9}, {3.5960580290895452`*^9, 3.59605803167243*^9}, {
  3.596058076449184*^9, 3.596058079891699*^9}, {3.596058150665659*^9, 
  3.596058151264716*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      FractionBox[
       SubscriptBox[
        OverscriptBox["u", "_"], 
        RowBox[{"-", "2"}]], "3"], "-", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox[
         OverscriptBox["u", "_"], 
         RowBox[{"-", "1"}]]}], "6"], "+", 
      FractionBox[
       RowBox[{"11", " ", 
        SubscriptBox[
         OverscriptBox["u", "_"], "0"]}], "6"]}]},
    {
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SubscriptBox[
         OverscriptBox["u", "_"], 
         RowBox[{"-", "1"}]], "6"]}], "+", 
      FractionBox[
       RowBox[{"5", " ", 
        SubscriptBox[
         OverscriptBox["u", "_"], "0"]}], "6"], "+", 
      FractionBox[
       SubscriptBox[
        OverscriptBox["u", "_"], "1"], "3"]}]},
    {
     RowBox[{
      FractionBox[
       SubscriptBox[
        OverscriptBox["u", "_"], "0"], "3"], "+", 
      FractionBox[
       RowBox[{"5", " ", 
        SubscriptBox[
         OverscriptBox["u", "_"], "1"]}], "6"], "-", 
      FractionBox[
       SubscriptBox[
        OverscriptBox["u", "_"], "2"], "6"]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.596056059816676*^9, 3.5960560760954437`*^9}, 
   3.596056198374035*^9, {3.5960562284410343`*^9, 3.596056254106703*^9}, 
   3.596056497703368*^9, {3.596057434984378*^9, 3.5960574612866497`*^9}, 
   3.5960575010457773`*^9, 3.596058032481578*^9, {3.5960580646777782`*^9, 
   3.59605808035214*^9}, 3.596058159485867*^9}]
}, Open  ]],

Cell[TextData[{
 "The interpolation at the reference point, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"i", "-", 
     RowBox[{"1", "/", "2"}]}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", is:"
}], "Text",
 CellChangeTimes->{{3.596057404445086*^9, 3.5960574071761427`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reconstructedN", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         SubscriptBox["P", "i"], ",", "x"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "\[CapitalDelta]x"}]}]}], "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.596057416872079*^9, 3.596057451626124*^9}, {
  3.596057495273561*^9, 3.596057495552321*^9}, {3.596058084273176*^9, 
  3.596058092912547*^9}, {3.596058155825925*^9, 3.596058156561145*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SubscriptBox[
         OverscriptBox["u", "_"], 
         RowBox[{"-", "2"}]], "6"]}], "+", 
      FractionBox[
       RowBox[{"5", " ", 
        SubscriptBox[
         OverscriptBox["u", "_"], 
         RowBox[{"-", "1"}]]}], "6"], "+", 
      FractionBox[
       SubscriptBox[
        OverscriptBox["u", "_"], "0"], "3"]}]},
    {
     RowBox[{
      FractionBox[
       SubscriptBox[
        OverscriptBox["u", "_"], 
        RowBox[{"-", "1"}]], "3"], "+", 
      FractionBox[
       RowBox[{"5", " ", 
        SubscriptBox[
         OverscriptBox["u", "_"], "0"]}], "6"], "-", 
      FractionBox[
       SubscriptBox[
        OverscriptBox["u", "_"], "1"], "6"]}]},
    {
     RowBox[{
      FractionBox[
       RowBox[{"11", " ", 
        SubscriptBox[
         OverscriptBox["u", "_"], "0"]}], "6"], "-", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox[
         OverscriptBox["u", "_"], "1"]}], "6"], "+", 
      FractionBox[
       SubscriptBox[
        OverscriptBox["u", "_"], "2"], "3"]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.596057422618249*^9, 3.59605746395645*^9}, 
   3.596057497509707*^9, {3.5960580647275543`*^9, 3.5960580937297792`*^9}, 
   3.596058160936256*^9}]
}, Open  ]],

Cell["\<\
Therefore this are our reconstructed polynomials. :D
M.D. 12.2012\
\>", "Text",
 CellChangeTimes->{{3.5960564105558434`*^9, 3.5960564450430117`*^9}, {
  3.5960572001316233`*^9, 3.596057200475257*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The Reconstruction of Reference Polynomial\
\>", "Section",
 CellChangeTimes->{{3.5960478391370487`*^9, 3.596047843704979*^9}, {
  3.596056589251276*^9, 3.5960566093791723`*^9}, {3.5960566426912537`*^9, 
  3.596056672523295*^9}, {3.596057032459854*^9, 3.596057034187508*^9}, {
  3.596057242411673*^9, 3.596057255763277*^9}, {3.596057974582753*^9, 
  3.596057975754928*^9}, {3.5960582287881927`*^9, 3.596058230276181*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["R", 
      RowBox[{"i", "+", 
       RowBox[{"1", "/", "2"}]}]], " ", "=", " ", 
     RowBox[{"\[ScriptU]", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"-", "3"}], ",", "2"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.596056714295536*^9, 3.596056742719067*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i", " ", "\[CapitalDelta]x"}], ",", 
       SubscriptBox["R", 
        RowBox[{"i", "+", 
         RowBox[{"1", "/", "2"}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "3"}], ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59605682711173*^9, 3.596056832063588*^9}, {
  3.596056932463945*^9, 3.5960569325199833`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"InterpolatingPolynomial", "[", 
    RowBox[{"data", ",", "x"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.596056836095171*^9, 3.5960568665263157`*^9}, 
   3.596056944351153*^9}],

Cell[TextData[{
 "The interpolation at the refencen, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"i", "+", 
     RowBox[{"1", "/", "2"}]}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", is:"
}], "Text",
 CellChangeTimes->{{3.596056375747291*^9, 3.596056405595428*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reconstructedR", " ", "=", " ", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{"D", "[", 
     RowBox[{"P", ",", "x"}], "]"}], "]"}], "/.", 
   RowBox[{"x", "\[Rule]", "0"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQfXVGK8PTE68chVIus4LoaoOF4iA6av5yKRCddl1t
85tTrxw3fTIH07JNb4+D6F8XIk6B6CfeTza9BdK1+8I2g+hfK4pvgOgJL1/d
BtEn56t9ANGPE2PB9AcbxS8gmom75xuIfne4u/wdkF73V64CRK9h6VoJotVm
LAHTm1YvWw+iQ3grN4PoLWvZd4JoO+XKgyBaanLTZbD6zSuug2ibPLXPIHqX
k9cXEM3yz17tPZBOOeSjDqIzNk7SBtHfDi0A06eOnQ4E0dcWXADTy3Rj1oPo
rkdLwbRFk9d5EH1iRSCYBgDJN8Jl
  "]],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox[
    OverscriptBox["u", "_"], 
    RowBox[{"-", "2"}]], "30"], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], 
     RowBox[{"-", "1"}]]}], "60"], "+", 
  FractionBox[
   RowBox[{"47", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], "0"]}], "60"], "+", 
  FractionBox[
   RowBox[{"9", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], "1"]}], "20"], "-", 
  FractionBox[
   SubscriptBox[
    OverscriptBox["u", "_"], "2"], "20"]}]], "Output",
 CellChangeTimes->{{3.596056897997307*^9, 3.59605693678608*^9}, 
   3.596057234405396*^9, 3.596057508810443*^9, 3.596057982412754*^9, {
   3.59605822130237*^9, 3.596058235955327*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reconstructedQ", " ", "=", " ", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{"D", "[", 
     RowBox[{"P", ",", "x"}], "]"}], "]"}], "/.", 
   RowBox[{"x", "\[Rule]", 
    RowBox[{"-", "\[CapitalDelta]x"}]}]}]}]], "Input",
 CellChangeTimes->{{3.596059815937717*^9, 3.5960598234484262`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SubscriptBox[
     OverscriptBox["u", "_"], 
     RowBox[{"-", "2"}]], "20"]}], "+", 
  FractionBox[
   RowBox[{"9", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], 
     RowBox[{"-", "1"}]]}], "20"], "+", 
  FractionBox[
   RowBox[{"47", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], "0"]}], "60"], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], "1"]}], "60"], "+", 
  FractionBox[
   SubscriptBox[
    OverscriptBox["u", "_"], "2"], "30"]}]], "Output",
 CellChangeTimes->{3.596059824302629*^9}]
}, Open  ]],

Cell["\<\
Exactly the same Polynomial show in equation 2.14 of  Ref. [1]. 
M.D. 12.2012\
\>", "Text",
 CellChangeTimes->{{3.5960569610592117`*^9, 3.596056985299642*^9}, {
  3.5960571615792713`*^9, 3.5960571918912497`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Build interpolating polynomial for an undefined x point", "Section",
 CellChangeTimes->{{3.5832086290623426`*^9, 3.583208644603232*^9}, {
  3.5832127136429677`*^9, 3.583212734547163*^9}, {3.583212791819439*^9, 
  3.5832128107475214`*^9}}],

Cell["\<\
to call our reconstructed polynomials we do:\
\>", "Text",
 CellChangeTimes->{{3.596056543344767*^9, 3.5960565647385473`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reconstructedP", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.59605650879618*^9, 3.5960565222708397`*^9}, {
  3.596058180119684*^9, 3.596058195703347*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox[
    OverscriptBox["u", "_"], "0"], "3"], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], "1"]}], "6"], "-", 
  FractionBox[
   SubscriptBox[
    OverscriptBox["u", "_"], "2"], "6"]}]], "Output",
 CellChangeTimes->{{3.5960565127710047`*^9, 3.596056522713889*^9}, {
  3.5960581808454323`*^9, 3.596058196141616*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reconstructedN", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.596058209854648*^9, 3.596058212502574*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox[
    OverscriptBox["u", "_"], 
    RowBox[{"-", "1"}]], "3"], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], "0"]}], "6"], "-", 
  FractionBox[
   SubscriptBox[
    OverscriptBox["u", "_"], "1"], "6"]}]], "Output",
 CellChangeTimes->{3.596058212909877*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["reconstructedR"], "Input",
 CellChangeTimes->{{3.596057994552919*^9, 3.596057998824745*^9}, {
  3.596058239527318*^9, 3.596058239694511*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox[
    OverscriptBox["u", "_"], 
    RowBox[{"-", "2"}]], "30"], "-", 
  FractionBox[
   RowBox[{"13", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], 
     RowBox[{"-", "1"}]]}], "60"], "+", 
  FractionBox[
   RowBox[{"47", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], "0"]}], "60"], "+", 
  FractionBox[
   RowBox[{"9", " ", 
    SubscriptBox[
     OverscriptBox["u", "_"], "1"]}], "20"], "-", 
  FractionBox[
   SubscriptBox[
    OverscriptBox["u", "_"], "2"], "20"]}]], "Output",
 CellChangeTimes->{
  3.596058000174836*^9, {3.596058215179989*^9, 3.5960582401324387`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Approximation for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", 
    RowBox[{"i", "+", 
     RowBox[{"1", "/", "2"}]}]], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.5832128577072077`*^9, 3.5832128739061337`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.596058880710396*^9, 3.596058882799377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientTable", "[", 
   RowBox[{"r_", ",", "A_"}], "]"}], ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"A", ",", 
      SubscriptBox[
       OverscriptBox["u", "_"], "i"]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"r", "-", "1"}], ")"}]}], ",", 
      RowBox[{"(", 
       RowBox[{"r", "-", "1"}], ")"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.596058815858983*^9, 3.596058934906335*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"contributor", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"reconstructedP", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "r"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.596058986809588*^9, 3.596059000415441*^9}, {
  3.596059048463866*^9, 3.5960592111446753`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     SubscriptBox[
      OverscriptBox["u", "_"], 
      RowBox[{"-", "2"}]], "3"], "-", 
    FractionBox[
     RowBox[{"7", " ", 
      SubscriptBox[
       OverscriptBox["u", "_"], 
       RowBox[{"-", "1"}]]}], "6"], "+", 
    FractionBox[
     RowBox[{"11", " ", 
      SubscriptBox[
       OverscriptBox["u", "_"], "0"]}], "6"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SubscriptBox[
       OverscriptBox["u", "_"], 
       RowBox[{"-", "1"}]], "6"]}], "+", 
    FractionBox[
     RowBox[{"5", " ", 
      SubscriptBox[
       OverscriptBox["u", "_"], "0"]}], "6"], "+", 
    FractionBox[
     SubscriptBox[
      OverscriptBox["u", "_"], "1"], "3"]}], ",", 
   RowBox[{
    FractionBox[
     SubscriptBox[
      OverscriptBox["u", "_"], "0"], "3"], "+", 
    FractionBox[
     RowBox[{"5", " ", 
      SubscriptBox[
       OverscriptBox["u", "_"], "1"]}], "6"], "-", 
    FractionBox[
     SubscriptBox[
      OverscriptBox["u", "_"], "2"], "6"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.596059067524592*^9, 3.5960591182812767`*^9}, {
   3.5960591585096893`*^9, 3.596059182720811*^9}, 3.596059222571179*^9, 
   3.59605965866899*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientTable", "[", 
   RowBox[{"r", ",", "contributor"}], "]"}], " ", "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.5960589458867188`*^9, 3.596058966468021*^9}, {
  3.596059268809804*^9, 3.596059287843041*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "3"], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["7", "6"]}], 
      RowBox[{"-", 
       FractionBox["1", "6"]}], "0"},
     {
      FractionBox["11", "6"], 
      FractionBox["5", "6"], 
      FractionBox["1", "3"]},
     {"0", 
      FractionBox["1", "3"], 
      FractionBox["5", "6"]},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", "6"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5960592532039003`*^9, 3.596059288358515*^9}, 
   3.5960596587726393`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientTable", "[", 
   RowBox[{"r", ",", "reconstructedR"}], "]"}], "//", "MatrixForm"}]], "Input",\

 CellChangeTimes->{{3.5960594125280237`*^9, 3.596059435957239*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox["1", "30"]},
      {
       RowBox[{"-", 
        FractionBox["13", "60"]}]},
      {
       FractionBox["47", "60"]},
      {
       FractionBox["9", "20"]},
      {
       RowBox[{"-", 
        FractionBox["1", "20"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5960594286997023`*^9, 3.596059436425537*^9}, 
   3.5960596587819757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LinearSolveWeights", "=", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{
    RowBox[{"CoefficientTable", "[", 
     RowBox[{"r", ",", "contributor"}], "]"}], ",", 
    RowBox[{"CoefficientTable", "[", 
     RowBox[{"r", ",", "reconstructedR"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.596059364961679*^9, 3.596059383008219*^9}, {
  3.596059457217291*^9, 3.596059458312361*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "10"], ",", 
   FractionBox["3", "5"], ",", 
   FractionBox["3", "10"]}], "}"}]], "Output",
 CellChangeTimes->{3.596059460344455*^9, 3.596059658890224*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Approximation for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", 
    RowBox[{"i", "-", 
     RowBox[{"1", "/", "2"}]}]], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.5832128577072077`*^9, 3.5832128739061337`*^9}, {
  3.583212983488402*^9, 3.5832129837054143`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.596058880710396*^9, 3.596058882799377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientTable", "[", 
   RowBox[{"r_", ",", "A_"}], "]"}], ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"A", ",", 
      SubscriptBox[
       OverscriptBox["u", "_"], "i"]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"r", "-", "1"}], ")"}]}], ",", 
      RowBox[{"(", 
       RowBox[{"r", "-", "1"}], ")"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.596058815858983*^9, 3.596058934906335*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"contributor", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"reconstructedN", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "j"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "r"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.596058986809588*^9, 3.596059000415441*^9}, {
  3.596059048463866*^9, 3.5960592111446753`*^9}, {3.596059514593339*^9, 
  3.596059514896669*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SubscriptBox[
       OverscriptBox["u", "_"], 
       RowBox[{"-", "2"}]], "6"]}], "+", 
    FractionBox[
     RowBox[{"5", " ", 
      SubscriptBox[
       OverscriptBox["u", "_"], 
       RowBox[{"-", "1"}]]}], "6"], "+", 
    FractionBox[
     SubscriptBox[
      OverscriptBox["u", "_"], "0"], "3"]}], ",", 
   RowBox[{
    FractionBox[
     SubscriptBox[
      OverscriptBox["u", "_"], 
      RowBox[{"-", "1"}]], "3"], "+", 
    FractionBox[
     RowBox[{"5", " ", 
      SubscriptBox[
       OverscriptBox["u", "_"], "0"]}], "6"], "-", 
    FractionBox[
     SubscriptBox[
      OverscriptBox["u", "_"], "1"], "6"]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"11", " ", 
      SubscriptBox[
       OverscriptBox["u", "_"], "0"]}], "6"], "-", 
    FractionBox[
     RowBox[{"7", " ", 
      SubscriptBox[
       OverscriptBox["u", "_"], "1"]}], "6"], "+", 
    FractionBox[
     SubscriptBox[
      OverscriptBox["u", "_"], "2"], "3"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.596059067524592*^9, 3.5960591182812767`*^9}, {
   3.5960591585096893`*^9, 3.596059182720811*^9}, 3.596059222571179*^9, 
   3.596059518839817*^9, 3.596059644821546*^9, 3.596059748461063*^9, 
   3.5960598368765097`*^9, 3.596059885058407*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientTable", "[", 
   RowBox[{"r", ",", "contributor"}], "]"}], " ", "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.5960589458867188`*^9, 3.596058966468021*^9}, {
  3.596059268809804*^9, 3.596059287843041*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox["1", "6"]}], "0", "0"},
     {
      FractionBox["5", "6"], 
      FractionBox["1", "3"], "0"},
     {
      FractionBox["1", "3"], 
      FractionBox["5", "6"], 
      FractionBox["11", "6"]},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", "6"]}], 
      RowBox[{"-", 
       FractionBox["7", "6"]}]},
     {"0", "0", 
      FractionBox["1", "3"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5960592532039003`*^9, 3.596059288358515*^9}, 
   3.596059518921196*^9, 3.596059644997851*^9, 3.596059771873426*^9, 
   3.5960598368862267`*^9, 3.596059885161045*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientTable", "[", 
   RowBox[{"r", ",", "reconstructedQ"}], "]"}], "//", "MatrixForm"}]], "Input",\

 CellChangeTimes->{{3.5960594125280237`*^9, 3.596059435957239*^9}, {
  3.59605983168225*^9, 3.596059831840602*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", 
        FractionBox["1", "20"]}]},
      {
       FractionBox["9", "20"]},
      {
       FractionBox["47", "60"]},
      {
       RowBox[{"-", 
        FractionBox["13", "60"]}]},
      {
       FractionBox["1", "30"]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5960594286997023`*^9, 3.596059436425537*^9}, 
   3.596059519020439*^9, 3.5960596450081997`*^9, 3.5960597772336063`*^9, 
   3.596059836977838*^9, 3.5960598851713037`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LinearSolveWeights", "=", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{
    RowBox[{"CoefficientTable", "[", 
     RowBox[{"r", ",", "contributor"}], "]"}], ",", 
    RowBox[{"CoefficientTable", "[", 
     RowBox[{"r", ",", "reconstructedQ"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.596059364961679*^9, 3.596059383008219*^9}, {
  3.596059457217291*^9, 3.596059458312361*^9}, {3.59605986964147*^9, 
  3.59605986984089*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["3", "10"], ",", 
   FractionBox["3", "5"], ",", 
   FractionBox["1", "10"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.596059460344455*^9, 3.596059519094953*^9, 3.5960596451321583`*^9, {
   3.5960597333699102`*^9, 3.59605978227028*^9}, 3.596059837091909*^9, 
   3.596059885251326*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final observations", "Subsection",
 CellChangeTimes->{{3.583213458292559*^9, 3.583213469459198*^9}}],

Cell["\<\
Observe the agreement of our results with Shu\[CloseCurlyQuote]s 2009 paper.
Here we can continue modifying this note book to compute higher order WENO \
approximations.

Cheers. ; )
Manuel Diaz, 12.2012.\
\>", "Text",
 CellChangeTimes->{{3.5832131128488007`*^9, 3.583213175347376*^9}, {
  3.5832132500356474`*^9, 3.5832132710918517`*^9}, {3.5832133300432234`*^9, 
  3.58321333959577*^9}, {3.596057113051565*^9, 3.596057122371166*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{768, 1344},
WindowMargins->{{Automatic, 0}, {Automatic, -335}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 231, 3, 92, "Title"],
Cell[813, 27, 307, 6, 50, "Subtitle"],
Cell[1123, 35, 253, 7, 31, "Input"],
Cell[CellGroupData[{
Cell[1401, 46, 146, 2, 44, "Subsection"],
Cell[1550, 50, 386, 7, 68, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1973, 62, 214, 4, 80, "Section"],
Cell[2190, 68, 569, 16, 32, "Text"],
Cell[CellGroupData[{
Cell[2784, 88, 860, 19, 34, "Input"],
Cell[3647, 109, 2273, 74, 52, "Output"]
}, Open  ]],
Cell[5935, 186, 330, 6, 31, "Text"],
Cell[6268, 194, 365, 12, 35, "Text"],
Cell[6636, 208, 384, 7, 31, "Text"],
Cell[7023, 217, 1020, 31, 41, "Text"],
Cell[8046, 250, 208, 4, 31, "Text"],
Cell[8257, 256, 884, 21, 62, "Input"],
Cell[9144, 279, 361, 11, 34, "Text"],
Cell[9508, 292, 1848, 53, 92, "Input"],
Cell[11359, 347, 806, 22, 76, "Text"],
Cell[12168, 371, 125, 3, 31, "Text"],
Cell[12296, 376, 2318, 67, 92, "Input"],
Cell[14617, 445, 122, 3, 31, "Text"],
Cell[14742, 450, 873, 18, 31, "Input"],
Cell[15618, 470, 357, 11, 34, "Text"],
Cell[CellGroupData[{
Cell[16000, 485, 1316, 25, 31, "Input"],
Cell[17319, 512, 1642, 52, 93, "Output"]
}, Open  ]],
Cell[18976, 567, 308, 10, 34, "Text"],
Cell[CellGroupData[{
Cell[19309, 581, 656, 16, 31, "Input"],
Cell[19968, 599, 1470, 50, 93, "Output"]
}, Open  ]],
Cell[21453, 652, 210, 5, 50, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21700, 662, 431, 7, 80, "Section"],
Cell[22134, 671, 404, 12, 31, "Input"],
Cell[22541, 685, 522, 15, 31, "Input"],
Cell[23066, 702, 240, 6, 31, "Input"],
Cell[23309, 710, 299, 10, 34, "Text"],
Cell[CellGroupData[{
Cell[23633, 724, 593, 14, 31, "Input"],
Cell[24229, 740, 735, 24, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25001, 769, 319, 8, 31, "Input"],
Cell[25323, 779, 615, 23, 47, "Output"]
}, Open  ]],
Cell[25953, 805, 222, 5, 50, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26212, 815, 244, 3, 115, "Section"],
Cell[26459, 820, 136, 3, 31, "Text"],
Cell[CellGroupData[{
Cell[26620, 827, 230, 5, 31, "Input"],
Cell[26853, 834, 412, 13, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27302, 852, 180, 4, 31, "Input"],
Cell[27485, 858, 355, 13, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27877, 876, 155, 2, 31, "Input"],
Cell[28035, 880, 644, 23, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28716, 908, 249, 8, 48, "Subsection"],
Cell[28968, 918, 138, 3, 31, "Input"],
Cell[29109, 923, 561, 17, 52, "Input"],
Cell[CellGroupData[{
Cell[29695, 944, 379, 10, 31, "Input"],
Cell[30077, 956, 1231, 43, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31345, 1004, 261, 6, 31, "Input"],
Cell[31609, 1012, 1052, 34, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32698, 1051, 209, 5, 31, "Input"],
Cell[32910, 1058, 947, 31, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33894, 1094, 408, 9, 52, "Input"],
Cell[34305, 1105, 215, 6, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34569, 1117, 300, 9, 48, "Subsection"],
Cell[34872, 1128, 138, 3, 31, "Input"],
Cell[35013, 1133, 561, 17, 52, "Input"],
Cell[CellGroupData[{
Cell[35599, 1154, 428, 11, 31, "Input"],
Cell[36030, 1167, 1326, 44, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37393, 1216, 261, 6, 31, "Input"],
Cell[37657, 1224, 1144, 35, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38838, 1264, 257, 6, 31, "Input"],
Cell[39098, 1272, 1043, 32, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40178, 1309, 455, 10, 52, "Input"],
Cell[40636, 1321, 341, 9, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41026, 1336, 106, 1, 44, "Subsection"],
Cell[41135, 1339, 445, 10, 109, "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
